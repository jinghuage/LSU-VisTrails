(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    109164,       2639]
NotebookOptionsPosition[    103619,       2458]
NotebookOutlinePosition[    104212,       2480]
CellTagsIndexPosition[    104169,       2477]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Reconstruct_Bullet.nb", "Subsubtitle",
 CellChangeTimes->{{3.463559121219228*^9, 3.4635591710291033`*^9}, {
  3.463657539277523*^9, 3.463657550890861*^9}, {3.4636887159644003`*^9, 
  3.463688778647987*^9}, {3.558543633460662*^9, 3.558543658562255*^9}, {
  3.558806431386598*^9, 3.5588064563744164`*^9}, {3.558806588334399*^9, 
  3.558806589596169*^9}, {3.5593932355081997`*^9, 3.5593932362412148`*^9}, {
  3.56908301042288*^9, 3.5690830666763487`*^9}, {3.569091305499346*^9, 
  3.5690913079927397`*^9}, {3.569138000828866*^9, 3.5691380183786907`*^9}, {
  3.632767437559787*^9, 3.632767437654932*^9}, {3.6712094843600473`*^9, 
  3.671209485005878*^9}, {3.671209582630579*^9, 3.671209584955101*^9}}],

Cell["\<\
A 3D volume of a bullet is reconstructed from neutron attenuation images \
acquired a the Paul Scherrer Institute neutron imaging facility.  An advanced \
neutron detector was developed by the University of California at Berkeley \
Space Sciences Laboratory.
The detector and neutron imaging are described in A.S. Tremsin, J.B. McPhate, \
J.V. Vallerga, O.H.W. Siegmund, W.B. Feller, E. Lehmann, L.G. Butler, M. \
Dawson, \[OpenCurlyDoubleQuote]High-resolution neutron microtomography with \
noiseless neutron counting detector\[CloseCurlyDoubleQuote], Nucl. Instr. \
Meth. A, 652 (2011) 400-403.\
\>", "Text",
 CellChangeTimes->{{3.6712094925982857`*^9, 3.6712094961289387`*^9}, {
  3.671209540448867*^9, 3.671209547960946*^9}, {3.6712095984785023`*^9, 
  3.6712097063369427`*^9}, {3.6712097457167473`*^9, 3.671209848920452*^9}}],

Cell["\<\
1. Initialization:  Sets image size, paths, 
2. Attenuation:  All attenuation images are calculated from the raw images, \
including flat field normalization.  Two images are defective, and are \
replaced with the average of adjacent images.
3. Sinogram: All sinograms are created.
4. Centering:
5. Reconstruction:
6. Volume:

The program reads raw data images (text files), computes attenuation images \
(replaces two images), creates sinograms, explores sinogram centering, \
reconstructs slices, and assembles a volume.
\
\>", "Text",
 CellChangeTimes->{{3.671210138953038*^9, 3.671210244723895*^9}, {
  3.671210787010337*^9, 3.671210816568618*^9}, {3.671210894294346*^9, 
  3.671211098462772*^9}}],

Cell[CellGroupData[{

Cell["Step 1:  Initialization", "Section",
 CellChangeTimes->{{3.461922498438747*^9, 3.4619225308505087`*^9}, {
  3.461924673305704*^9, 3.461924676023527*^9}, {3.461928908417576*^9, 
  3.461928926480349*^9}, {3.461941819300048*^9, 3.461941819938244*^9}, {
  3.462073298396008*^9, 3.462073300887827*^9}, {3.462076671629527*^9, 
  3.462076672835554*^9}, {3.5593932468584547`*^9, 3.559393282754834*^9}, {
  3.671209446222226*^9, 3.671209450195938*^9}}],

Cell[CellGroupData[{

Cell["1.a Image size, Paths", "Subsection",
 CellChangeTimes->{{3.671211179812208*^9, 3.671211200099522*^9}, {
  3.671211329699849*^9, 3.671211331226242*^9}}],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"pathRoot", " ", "=", " ", 
  "\"\</melete-nas01/lsu/scratch/BulletData/\>\""}]}], "Input",
 CellChangeTimes->{{3.5690827242464733`*^9, 3.5690827361321087`*^9}, {
  3.5690830925597467`*^9, 3.569083092840145*^9}, {3.569097435621499*^9, 
  3.569097436326882*^9}, {3.671211207336076*^9, 3.671211218893112*^9}, {
  3.6712123236458607`*^9, 3.671212334652505*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NX", " ", "=", "256"}], ";", " ", 
   RowBox[{"NY", "=", "256"}], ";"}], " "}]], "Input"],

Cell[BoxData[{
 RowBox[{"NotebookDirectory", "[", 
  "]"}], "\[IndentingNewLine]", "$OperatingSystem", "\[IndentingNewLine]", \
"$HomeDirectory"}], "Input",
 CellChangeTimes->{{3.573312524413568*^9, 3.573312533806274*^9}, {
  3.6699657519922667`*^9, 3.669965752391191*^9}, {3.671207822924098*^9, 
  3.6712078266990232`*^9}}],

Cell[BoxData[{
 RowBox[{"DirectoryQ", "[", 
  RowBox[{"pathRawData", " ", "=", "  ", 
   RowBox[{"pathRoot", "<>", "\"\<raw_bullet_images/\>\""}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"DirectoryQ", "[", 
  RowBox[{"pathFigures", " ", "=", "  ", 
   RowBox[{"pathRoot", "<>", "\"\<figures/\>\""}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"DirectoryQ", "[", 
  RowBox[{"pathAttenuation", " ", "=", "  ", 
   RowBox[{"pathRoot", "<>", "\"\<attenuation/\>\""}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"DirectoryQ", "[", 
  RowBox[{"pathSinograms", " ", "=", "  ", 
   RowBox[{"pathRoot", "<>", "\"\<sinograms/\>\""}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"DirectoryQ", "[", 
  RowBox[{"pathSlices", "=", "  ", 
   RowBox[{"pathRoot", "<>", "\"\<slices/\>\""}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"DirectoryQ", "[", 
  RowBox[{"pathVolumes", "=", "  ", 
   RowBox[{"pathRoot", "<>", "\"\<volumes/\>\""}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.671211460614613*^9, 3.671211476745566*^9}, {
   3.671211637505755*^9, 3.6712116400978537`*^9}, {3.671211691166164*^9, 
   3.671211775362187*^9}, {3.67121194090945*^9, 3.6712121011938677`*^9}, 
   3.6712122966880913`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["1.b Define image processing functions", "Subsection",
 CellChangeTimes->{{3.671211179812208*^9, 3.671211200099522*^9}, {
  3.671211329699849*^9, 3.6712113538193483`*^9}}],

Cell["\<\
funcFilterRawImages[raw_]
In a high radiation environment, even if shielded from the main radiation \
beam, a detector can be damaged at the the pixel level. ONe strategy is to \
replace the bad pixel with an average of its neighbors.  \
\>", "Text",
 CellChangeTimes->{{3.5690831981943007`*^9, 3.56908328337036*^9}, {
  3.5690833387160378`*^9, 3.569083643772579*^9}, {3.56908367658139*^9, 
  3.569083685269905*^9}, {3.569087100914606*^9, 3.5690872866373987`*^9}, {
  3.671216897103608*^9, 3.6712169733790493`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"funcFilterRawImages", "[", "raw_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "anyZeros", ",", "filtered", ",", "r", ",", "c", ",", 
       "medianFiltered"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"filtered", "=", "raw"}], ";", "\[IndentingNewLine]", 
      RowBox[{"anyZeros", "=", " ", 
       RowBox[{"Position", "[", 
        RowBox[{"raw", ",", " ", 
         RowBox[{"p_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", "\[LessEqual]", "0"}], " ", "&"}], ")"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"medianFiltered", " ", "=", " ", 
       RowBox[{"MedianFilter", "[", 
        RowBox[{"raw", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "anyZeros", "]"}], ">", "0"}], ",", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", " ", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i", "=", "1"}], ",", 
            RowBox[{"i", "<=", 
             RowBox[{"Length", "[", "anyZeros", "]"}]}], ",", 
            RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"r", ",", "c"}], "}"}], "=", 
              RowBox[{"anyZeros", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"filtered", "[", 
               RowBox[{"[", 
                RowBox[{"r", ",", "c"}], "]"}], "]"}], " ", "=", " ", 
              RowBox[{"medianFiltered", "[", 
               RowBox[{"[", 
                RowBox[{"r", ",", "c"}], "]"}], "]"}]}], ";"}]}], "  ", 
           "]"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "filtered"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.671214051091303*^9, 3.671214129632346*^9}, {
  3.671214196843514*^9, 3.671214217699003*^9}, {3.671214297487451*^9, 
  3.6712143438694487`*^9}, {3.6712146397128773`*^9, 3.671214682262487*^9}, {
  3.67121488387843*^9, 3.671214889989427*^9}, {3.671215091375135*^9, 
  3.671215096407832*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"funcFilterAttenuation", "[", 
    RowBox[{"data_", ",", "upperLimit_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "anyZeros", ",", "anyZingers", ",", "filtered", ",", "r", ",", "c", ",",
        "medianFiltered"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"filtered", "=", "data"}], ";", "\[IndentingNewLine]", 
      RowBox[{"anyZeros", "=", " ", 
       RowBox[{"Position", "[", 
        RowBox[{"data", ",", " ", 
         RowBox[{"p_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", "\[LessEqual]", "0"}], " ", "&"}], ")"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"medianFiltered", " ", "=", " ", 
       RowBox[{"MedianFilter", "[", 
        RowBox[{"data", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "anyZeros", "]"}], ">", "0"}], ",", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", " ", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i", "=", "1"}], ",", 
            RowBox[{"i", "<=", 
             RowBox[{"Length", "[", "anyZeros", "]"}]}], ",", 
            RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"r", ",", "c"}], "}"}], "=", 
              RowBox[{"anyZeros", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"filtered", "[", 
               RowBox[{"[", 
                RowBox[{"r", ",", "c"}], "]"}], "]"}], " ", "=", " ", 
              RowBox[{"medianFiltered", "[", 
               RowBox[{"[", 
                RowBox[{"r", ",", "c"}], "]"}], "]"}]}], ";"}]}], "  ", 
           "]"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"anyZingers", "=", " ", 
       RowBox[{"Position", "[", 
        RowBox[{"data", ",", " ", 
         RowBox[{"p_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", ">", "upperLimit"}], " ", "&"}], ")"}]}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "anyZingers", "]"}], ">", "0"}], ",", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", " ", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i", "=", "1"}], ",", 
            RowBox[{"i", "<=", 
             RowBox[{"Length", "[", "anyZingers", "]"}]}], ",", 
            RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"r", ",", "c"}], "}"}], "=", 
              RowBox[{"anyZingers", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"filtered", "[", 
               RowBox[{"[", 
                RowBox[{"r", ",", "c"}], "]"}], "]"}], " ", "=", " ", 
              RowBox[{"medianFiltered", "[", 
               RowBox[{"[", 
                RowBox[{"r", ",", "c"}], "]"}], "]"}]}], ";"}]}], "  ", 
           "]"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "filtered"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6712880843542128`*^9, 3.671288213364456*^9}, {
  3.671290357437093*^9, 3.671290362678831*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"funcShiftSinogram", "[", 
    RowBox[{
    "sinogram_", ",", "shift_", ",", "numberColumns_", ",", 
     "numberOfAngles_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "rInitial", ",", "cInitial", ",", "rFinal", ",", "cFinal", ",", 
       "sinoShifted"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"rInitial", ",", "cInitial"}], "}"}], "=", 
       RowBox[{"Dimensions", "[", "sinogram", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"shift", ">", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{"sinoShifted", " ", "=", " ", 
         RowBox[{"Transpose", "[", 
          RowBox[{"PadRight", "[", 
           RowBox[{
            RowBox[{"Take", "[", 
             RowBox[{
              RowBox[{"Transpose", "[", "sinogram", "]"}], ",", "All", ",", 
              RowBox[{"{", 
               RowBox[{"shift", ",", "numberColumns"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"numberOfAngles", ",", "numberColumns"}], "}"}], ",", 
            "0"}], "]"}], " ", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"shift", "<", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{"sinoShifted", " ", "=", " ", 
         RowBox[{"Transpose", "[", 
          RowBox[{"PadLeft", "[", 
           RowBox[{
            RowBox[{"Take", "[", 
             RowBox[{
              RowBox[{"Transpose", "[", "sinogram", "]"}], ",", "All", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"numberColumns", "+", "shift"}]}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"numberOfAngles", ",", "numberColumns"}], "}"}], ",", 
            "0"}], "]"}], " ", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"shift", "==", "0"}], ",", 
        RowBox[{"sinoShifted", " ", "=", "sinogram"}]}], " ", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"rFinal", ",", "cFinal"}], "}"}], "=", 
       RowBox[{"Dimensions", "[", "sinoShifted", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"error", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"rInitial", ",", "cInitial"}], "}"}], "\[Equal]", 
          RowBox[{"{", 
           RowBox[{"rFinal", ",", "cFinal"}], "}"}]}], ",", "0", ",", "1"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "sinoShifted"}]}], "  ", "]"}]}],
   ";"}]], "Input",
 CellChangeTimes->{
  3.671290364350119*^9, {3.67129064361721*^9, 3.671290645432549*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"funcStreakRemovalFFT", "[", 
    RowBox[{"sinogram_", ",", "bandWidth_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "numberRays", ",", "numberOfAngles", ",", "streaks", ",", 
       "streaksHighPassFilter"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"numberRays", ",", "numberOfAngles"}], "}"}], "=", 
       RowBox[{"Dimensions", "[", "sinogram", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"streaks", " ", "=", " ", 
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{"sinogram", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}], "/", "numberOfAngles"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"streaksHighPassFilter", " ", "=", " ", 
       RowBox[{"HighpassFilter", "[", 
        RowBox[{"streaks", ",", "bandWidth"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sinogram", "-", "streaksHighPassFilter"}]}]}], " ", "]"}]}], 
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"funcUseAirRegionForOffsetSinogram", "[", 
    RowBox[{"data_", ",", "airRegionWidth_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "numberRays", ",", "numberOfAngles", ",", "airTop", ",", "airBottom", 
       ",", "tempSinogram", ",", "indexAngle", ",", "sinogram"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sinogram", " ", "=", " ", "data"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"numberRays", ",", "numberOfAngles"}], "}"}], "=", 
       RowBox[{"Dimensions", "[", "data", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"indexAngle", " ", "=", "1"}], ",", " ", 
        RowBox[{"indexAngle", "\[LessEqual]", "numberOfAngles"}], ",", 
        RowBox[{"indexAngle", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"airTop", " ", "=", " ", 
          RowBox[{"Median", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"Take", "[", 
             RowBox[{"sinogram", ",", " ", 
              RowBox[{"{", 
               RowBox[{"1", ",", "airRegionWidth"}], "}"}], ",", 
              RowBox[{"{", "indexAngle", "}"}]}], "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"airBottom", " ", "=", "  ", 
          RowBox[{"Median", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"Take", "[", 
             RowBox[{"sinogram", ",", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"numberRays", "-", "airRegionWidth", "+", "1"}], ",", 
                "numberRays"}], "}"}], ",", 
              RowBox[{"{", "indexAngle", "}"}]}], "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"sinogram", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "indexAngle"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"sinogram", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "indexAngle"}], "]"}], "]"}], "-", 
           RowBox[{"Mean", "[", 
            RowBox[{"{", 
             RowBox[{"airTop", ",", "airBottom"}], "}"}], "]"}]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "sinogram"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.671290867554008*^9, 3.6712909028839684`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["1.c DumpSave", "Subsection",
 CellChangeTimes->{{3.671211179812208*^9, 3.671211200099522*^9}, {
   3.671211329699849*^9, 3.671211387716975*^9}, 3.6712140481610613`*^9}],

Cell[BoxData[{
 RowBox[{"DumpSave", "[", 
  RowBox[{
   RowBox[{"pathRoot", "<>", "\"\<step_1.mx\>\""}], ",", 
   RowBox[{"{", 
    RowBox[{
    "NX", ",", " ", "NY", ",", "pathRoot", ",", " ", "pathAttenuation", ",", 
     "pathFigures", ",", "pathRawData", ",", "pathSinograms", ",", 
     "pathSlices", ",", "pathVolumes", ",", " ", "funcFilterRawImages", ",", 
     "funcFilterAttenuation", ",", "funcShiftSinogram", ",", 
     "funcStreakRemovalFFT", ",", "funcUseAirRegionForOffsetSinogram"}], " ", 
    "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]}], "Input",
 CellChangeTimes->{{3.670170392983385*^9, 3.67017042465975*^9}, {
   3.671211431687812*^9, 3.671211434265087*^9}, {3.671212120717972*^9, 
   3.6712121815361853`*^9}, 3.6712127961361732`*^9, 3.67121556974704*^9, {
   3.6712882389950333`*^9, 3.671288239322644*^9}, {3.671290370544409*^9, 
   3.671290371007855*^9}, {3.6712940600693283`*^9, 3.671294063443318*^9}, 
   3.671294170100638*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Step 2.  Attenuation at the first rotation angle", "Section",
 CellChangeTimes->{{3.4562833726280527`*^9, 3.456283385607916*^9}, {
   3.463555031609515*^9, 3.463555047770688*^9}, 3.463590933610998*^9, 
   3.463591573151423*^9, {3.463681205490497*^9, 3.463681218422361*^9}, {
   3.5593946201427183`*^9, 3.5593947037242002`*^9}, {3.67121112647265*^9, 
   3.67121112813605*^9}, {3.671216985158723*^9, 3.671217006916567*^9}}],

Cell[BoxData[{
 RowBox[{"pathRoot", " ", "=", " ", 
  "\"\</melete-nas01/lsu/scratch/BulletData/\>\""}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", 
  RowBox[{"pathRoot", "<>", "\"\<step_1.mx\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"grayScalePlotLimits", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.2"}], ",", "1.5"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6712125294719152`*^9, 3.671212529841263*^9}, {
  3.6712850065473967`*^9, 3.671285020004031*^9}}],

Cell[CellGroupData[{

Cell["2.a  Open Beam", "Subsection",
 CellChangeTimes->{{3.463681235019806*^9, 3.463681239118738*^9}, {
   3.559402913655099*^9, 3.559402916675728*^9}, 3.559408563228389*^9, {
   3.6712126432221727`*^9, 3.671212646004011*^9}, 3.6712138958338118`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"openBeam", " ", "=", " ", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{"pathRawData", "<>", "\"\<OpenBeam_600s\>\""}], ",", 
     "\"\<Table\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"openBeam", "=", 
   RowBox[{"funcFilterRawImages", "[", "openBeam", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Dimensions", "[", "openBeam", "]"}], ",", 
    RowBox[{"Min", "[", "openBeam", "]"}], ",", 
    RowBox[{"Mean", "[", 
     RowBox[{"Flatten", "[", "openBeam", "]"}], "]"}], ",", 
    RowBox[{"Max", "[", "openBeam", "]"}]}], "}"}], "//", 
  "N"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"gOpenBeam", " ", "=", " ", 
    RowBox[{"ArrayPlot", "[", 
     RowBox[{"openBeam", ",", " ", 
      RowBox[{"ImageSize", "\[Rule]", "200"}]}], "]"}]}], "*)"}]}]}], "Input",\

 CellChangeTimes->{{3.671213489767893*^9, 3.67121349179849*^9}, {
  3.671213529144813*^9, 3.671213530192561*^9}, {3.671213672137645*^9, 
  3.6712137408611937`*^9}, {3.671215117399642*^9, 3.671215121587098*^9}, {
  3.6712175760108356`*^9, 3.671217579319735*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["2.b  Dark ", "Subsection",
 CellChangeTimes->{{3.463681235019806*^9, 3.463681239118738*^9}, {
  3.4636812810301037`*^9, 3.463681284108108*^9}, {3.559402924103815*^9, 
  3.559402926492178*^9}, {3.671213881766789*^9, 3.671213892849856*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dark", " ", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{
     "pathRawData", "<>", "\"\<DarkImage_FastShutterClosed_100s\>\""}], ",", 
     "\"\<Table\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dark", "=", 
   RowBox[{"funcFilterRawImages", "[", "dark", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Dimensions", "[", "dark", "]"}], ",", 
    RowBox[{"Min", "[", "dark", "]"}], ",", 
    RowBox[{"Mean", "[", 
     RowBox[{"Flatten", "[", "dark", "]"}], "]"}], ",", 
    RowBox[{"Max", "[", "dark", "]"}]}], "}"}], "//", "N"}]}], "Input",
 CellChangeTimes->{
  3.4635550898220387`*^9, {3.463555187129627*^9, 3.463555217998516*^9}, {
   3.4635552493949013`*^9, 3.463555264604661*^9}, {3.4635553254209557`*^9, 
   3.4635553423386927`*^9}, {3.463555388698943*^9, 3.463555423096471*^9}, {
   3.463555521911644*^9, 3.463555538410522*^9}, {3.46355556930846*^9, 
   3.4635555814041653`*^9}, {3.463555635083866*^9, 3.4635556738058*^9}, {
   3.4635574625382967`*^9, 3.46355747088731*^9}, {3.463557866447913*^9, 
   3.4635578804235086`*^9}, 3.463590449468005*^9, 3.4635918105168743`*^9, 
   3.463592590679975*^9, 3.463643929216219*^9, {3.463657719022374*^9, 
   3.463657803631394*^9}, {3.558530712973063*^9, 3.558530734149225*^9}, 
   3.5588076195111933`*^9, {3.5594061460211897`*^9, 3.559406146314702*^9}, 
   3.569087451235135*^9, 3.671213435125441*^9, {3.671213763174243*^9, 
   3.671213815086522*^9}, {3.67121514571437*^9, 3.6712151510044518`*^9}, {
   3.67121755935395*^9, 3.6712175673480673`*^9}, {3.671290392538391*^9, 
   3.6712903928150873`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["2.c  Read 0 degree raw and make attenuation image", "Subsection",
 CellChangeTimes->{{3.463681235019806*^9, 3.463681239118738*^9}, {
  3.4636812810301037`*^9, 3.463681320410509*^9}, {3.4636884155661707`*^9, 
  3.463688422605754*^9}, {3.5594029324307137`*^9, 3.55940293758097*^9}, {
  3.671213928011793*^9, 3.671213956541156*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"raw", " ", "=", " ", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{"pathRawData", "<>", "\"\<Bullet   0.0\>\""}], ",", 
     "\"\<Table\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"raw", "=", 
   RowBox[{"funcFilterRawImages", "[", "raw", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Dimensions", "[", "raw", "]"}], ",", 
    RowBox[{"Min", "[", "raw", "]"}], ",", 
    RowBox[{"Mean", "[", 
     RowBox[{"Flatten", "[", "raw", "]"}], "]"}], ",", 
    RowBox[{"Max", "[", "raw", "]"}]}], "}"}], "//", "N"}]}], "Input",
 CellChangeTimes->{{3.463557285457293*^9, 3.463557370053482*^9}, {
   3.463557851632704*^9, 3.4635578873049393`*^9}, 3.4635904545952053`*^9, {
   3.463657833086631*^9, 3.463657886545176*^9}, {3.558530746047183*^9, 
   3.5585307513651533`*^9}, {3.558718006521886*^9, 3.558718033938663*^9}, {
   3.5587188767721977`*^9, 3.558718877914225*^9}, 3.558807893298181*^9, {
   3.559406140333269*^9, 3.5594061406099052`*^9}, 3.569087451241983*^9, {
   3.671213962413763*^9, 3.6712140014555197`*^9}, {3.671215163666994*^9, 
   3.6712151848862467`*^9}, {3.671215285146529*^9, 3.671215285615752*^9}, {
   3.671217546721415*^9, 3.6712175501015387`*^9}, {3.671288306748261*^9, 
   3.6712883070681133`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"attenuation", " ", "=", " ", 
   RowBox[{
    RowBox[{"Re", "[", 
     RowBox[{"Log", "[", " ", 
      FractionBox[
       RowBox[{
        RowBox[{"openBeam", "/", "600"}], " ", "-", " ", 
        RowBox[{"dark", "/", "100"}]}], 
       RowBox[{
        RowBox[{"raw", "/", "140"}], "-", " ", 
        RowBox[{"dark", "/", "100"}]}]], "]"}], "]"}], "//", "N"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Dimensions", "[", "attenuation", "]"}], ",", 
   RowBox[{"Min", "[", "attenuation", "]"}], ",", 
   RowBox[{"Mean", "[", 
    RowBox[{"Flatten", "[", "attenuation", "]"}], "]"}], ",", 
   RowBox[{"Max", "[", "attenuation", "]"}]}], "}"}]}], "Input",
 CellChangeTimes->{{3.569089348948554*^9, 3.569089389627872*^9}, {
  3.671215206781271*^9, 3.671215226188489*^9}, {3.671288265587963*^9, 
  3.671288347915422*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["2.d  Normalize the intensity values based on air region ", "Subsection",
 CellChangeTimes->{{3.463681235019806*^9, 3.463681239118738*^9}, {
   3.4636812810301037`*^9, 3.463681320410509*^9}, {3.4636884155661707`*^9, 
   3.463688422605754*^9}, {3.559402967320506*^9, 3.559403030512142*^9}, {
   3.6712157011448517`*^9, 3.6712157031398277`*^9}, 3.6712159331116734`*^9}],

Cell["\<\
After normalization, the air region should have an average intensity value of \
0. 
The object region is forced to have an constant average intensity.  
We use a linear equation for the normalization:       corrected intensity = \
uncorrected intensity - offset\
\>", "Text",
 CellChangeTimes->{{3.559405664523237*^9, 3.5594057240442677`*^9}, {
   3.559405765448018*^9, 3.55940582315212*^9}, {3.5594059482700453`*^9, 
   3.559405952095766*^9}, {3.5594059964714413`*^9, 3.559406000295273*^9}, {
   3.6712157093881083`*^9, 3.6712157095000257`*^9}, 3.6712159301642647`*^9, {
   3.671257996934586*^9, 3.6712580321299467`*^9}, {3.671259635234172*^9, 
   3.6712596612650537`*^9}, {3.671285351941337*^9, 3.67128535398729*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"airRegion", " ", "=", " ", 
   RowBox[{"MedianFilter", "[", 
    RowBox[{
     RowBox[{"attenuation", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", 
        RowBox[{"220", ";;", "NX"}]}], "]"}], "]"}], ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"offset", " ", "=", " ", 
   RowBox[{"Mean", "[", 
    RowBox[{"Flatten", "[", "airRegion", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"attenuation", "=", 
   RowBox[{"attenuation", "-", "offset"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"attenuation", "=", 
   RowBox[{"funcFilterAttenuation", "[", 
    RowBox[{"attenuation", ",", 
     RowBox[{"Max", "[", "grayScalePlotLimits", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"offset", ",", 
    RowBox[{"Min", "[", "attenuation", "]"}], ",", 
    RowBox[{"Mean", "[", 
     RowBox[{"Flatten", "[", "attenuation", "]"}], "]"}], ",", 
    RowBox[{"Max", "[", "attenuation", "]"}]}], "}"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gHist", "=", 
   RowBox[{"Histogram", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", "attenuation", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Min", "[", "grayScalePlotLimits", "]"}], ",", 
       RowBox[{"Max", "[", "grayScalePlotLimits", "]"}], ",", "0.02"}], "}"}],
      ",", "\"\<LogCount\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gLineProbe", "=", 
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{"attenuation", "[", 
      RowBox[{"[", 
       RowBox[{"128", ",", "All"}], "]"}], "]"}], ",", " ", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", " ", 
     RowBox[{"AxesOrigin", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.463690369273052*^9, 3.463690495391594*^9}, {
   3.463695461451705*^9, 3.463695474772257*^9}, {3.4636955258493547`*^9, 
   3.46369560550599*^9}, {3.463695637971018*^9, 3.4636956427335463`*^9}, {
   3.558530989567286*^9, 3.558531050432662*^9}, {3.558531262196196*^9, 
   3.558531291209807*^9}, {3.55853167659273*^9, 3.558531739720172*^9}, {
   3.558533006422615*^9, 3.558533069912903*^9}, 3.5585332262168417`*^9, {
   3.5587104720235*^9, 3.558710517653599*^9}, 3.55881021223807*^9, {
   3.559403051477191*^9, 3.559403071931089*^9}, 3.5594033545990257`*^9, {
   3.559403395772565*^9, 3.559403426096884*^9}, 3.559403458127368*^9, {
   3.559403590072126*^9, 3.559403591421124*^9}, {3.559405760053669*^9, 
   3.559405760399428*^9}, {3.559405895559888*^9, 3.559405928148396*^9}, 
   3.559406021929412*^9, {3.559406110863963*^9, 3.559406111247995*^9}, {
   3.67121571792142*^9, 3.671215725809346*^9}, {3.6712157854740953`*^9, 
   3.671215844236911*^9}, 3.6712158884911613`*^9, {3.671215951626947*^9, 
   3.6712160012753763`*^9}, {3.671216041409561*^9, 3.671216061910293*^9}, 
   3.671216102651135*^9, {3.6712174817572536`*^9, 3.671217508469262*^9}, {
   3.671258050169016*^9, 3.671258062445278*^9}, {3.671259598086431*^9, 
   3.6712596204462967`*^9}, 3.671274156679064*^9, {3.671274450063106*^9, 
   3.671274479176536*^9}, {3.671285340119031*^9, 3.671285363780493*^9}, {
   3.6712853960339193`*^9, 3.671285449656942*^9}, {3.671288361419203*^9, 
   3.671288385626338*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
2.e  Rotate the attenuation image by 90 degree and save as *.fits\
\>", "Subsection",
 CellChangeTimes->{{3.463681235019806*^9, 3.463681239118738*^9}, {
   3.4636812810301037`*^9, 3.463681320410509*^9}, {3.4636884155661707`*^9, 
   3.463688422605754*^9}, {3.559402967320506*^9, 3.559403030512142*^9}, {
   3.5594036623719883`*^9, 3.559403681298482*^9}, {3.5594060422254553`*^9, 
   3.559406055017336*^9}, 3.5594087844343157`*^9, {3.671216194099779*^9, 
   3.6712162131648827`*^9}, {3.671216624613289*^9, 3.671216625497889*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"attenuation", " ", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{"Transpose", "[", " ", "attenuation", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"pathAttenuation", "<>", "\"\<attenuation_0deg.fits\>\""}], ",", 
    "attenuation"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.559406061092998*^9, 3.559406102494329*^9}, {
   3.559408772498098*^9, 3.559408772850957*^9}, 3.5690970977656717`*^9, {
   3.671216223738215*^9, 3.6712162695802298`*^9}, {3.671217441982087*^9, 
   3.6712174637852993`*^9}, 3.6712744709133987`*^9, {3.6712853725808287`*^9, 
   3.6712853817168713`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["2.f  Set grayscale plot limits, replot, and save as *.png", "Subsection",
 CellChangeTimes->{{3.463681235019806*^9, 3.463681239118738*^9}, {
   3.4636812810301037`*^9, 3.463681320410509*^9}, {3.4636884155661707`*^9, 
   3.463688422605754*^9}, {3.559402967320506*^9, 3.559403030512142*^9}, {
   3.5594036623719883`*^9, 3.559403681298482*^9}, 3.559406037931231*^9, {
   3.559408732318734*^9, 3.55940873542059*^9}, 3.5594087887042103`*^9, {
   3.6712166298821373`*^9, 3.671216631145976*^9}, {3.6712744365807962`*^9, 
   3.671274437263259*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"gAttenuation", "=", " ", 
   RowBox[{"ArrayPlot", "[", 
    RowBox[{"attenuation", ",", 
     RowBox[{"PlotRange", "->", "grayScalePlotLimits"}], ",", 
     RowBox[{"ClippingStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"White", ",", "Black"}], "}"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", "True"}], ",", " ", 
     RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "200"}], ",", 
     RowBox[{"ColorFunction", "\[Rule]", "\"\<GrayTones\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Placed", "[", 
        RowBox[{
         RowBox[{"BarLegend", "[", 
          RowBox[{"{", 
           RowBox[{"\"\<GrayTones\>\"", ",", "grayScalePlotLimits"}], "}"}], 
          "]"}], ",", "Right"}], "]"}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.559403709063161*^9, 3.559403720679544*^9}, {
   3.559403771261688*^9, 3.5594038268762903`*^9}, {3.55940621662897*^9, 
   3.559406304888317*^9}, 3.671216276932684*^9, {3.671217174113825*^9, 
   3.671217178647603*^9}, 3.671217289264448*^9, {3.671217348872847*^9, 
   3.671217353751799*^9}, 3.671217600102026*^9, 3.671274281995984*^9, {
   3.671274315460346*^9, 3.671274323760426*^9}, {3.671274359833948*^9, 
   3.671274387554315*^9}, 3.671285465075238*^9}],

Cell[BoxData[{
 RowBox[{"gAll", "=", 
  RowBox[{"GraphicsGrid", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"gAttenuation", ",", "gHist", ",", "gLineProbe"}], "}"}], "}"}],
     ",", 
    RowBox[{"ImageSize", "\[Rule]", "800"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"pathFigures", "<>", "\"\<attenuation_0deg.png\>\""}], ",", 
    "gAll", ",", "\"\<png\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.558531914946233*^9, {3.5585319482279043`*^9, 3.558531983388801*^9}, {
   3.559403615888074*^9, 3.5594036163824987`*^9}, {3.559406343898468*^9, 
   3.559406344386229*^9}, {3.5594087464159927`*^9, 3.5594087564787903`*^9}, 
   3.670170659658041*^9, {3.671216551153067*^9, 3.671216587488337*^9}, {
   3.671216827831085*^9, 3.671216829444378*^9}, {3.671217234714539*^9, 
   3.671217251225471*^9}, {3.67121734163192*^9, 3.671217389360252*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["2.g DumpSave", "Subsection",
 CellChangeTimes->{{3.671211179812208*^9, 3.671211200099522*^9}, {
   3.671211329699849*^9, 3.671211387716975*^9}, 3.6712140481610613`*^9, {
   3.6712166499891567`*^9, 3.671216651875024*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DumpSave", "[", 
   RowBox[{
    RowBox[{"pathRoot", "<>", "\"\<step_2.mx\>\""}], ",", 
    RowBox[{"{", 
     RowBox[{"openBeam", ",", "dark", ",", " ", "grayScalePlotLimits"}], 
     "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]}], "Input",
 CellChangeTimes->{{3.670170487070524*^9, 3.670170492548648*^9}, {
   3.670170608253581*^9, 3.6701706092764063`*^9}, {3.671216602745532*^9, 
   3.671216611939556*^9}, {3.6712166842956038`*^9, 3.671216690287579*^9}, 
   3.671216778684046*^9, 3.671217190175748*^9, {3.6712253696102533`*^9, 
   3.671225371499885*^9}, {3.67123037984468*^9, 3.671230387994924*^9}, 
   3.67127429309704*^9, 3.671284950714406*^9}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Step 3.  Attenuation", "Section",
 CellChangeTimes->{{3.4562833726280527`*^9, 3.456283385607916*^9}, {
   3.463555031609515*^9, 3.463555047770688*^9}, 3.463590933610998*^9, 
   3.463591573151423*^9, {3.463681205490497*^9, 3.463681218422361*^9}, {
   3.5593946201427183`*^9, 3.5593947548622437`*^9}, 3.559402953846599*^9, 
   3.569097394235346*^9, {3.569143279919381*^9, 3.56914328545807*^9}, {
   3.6712176700185833`*^9, 3.671217671749419*^9}}],

Cell[BoxData[{
 RowBox[{"pathRoot", " ", "=", " ", 
  "\"\</melete-nas01/lsu/scratch/BulletData/\>\""}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", 
  RowBox[{"pathRoot", "<>", "\"\<step_1.mx\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", 
  RowBox[{"pathRoot", "<>", "\"\<step_2.mx\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"grayScalePlotLimits", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.1"}], ",", "1.5"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6712125294719152`*^9, 3.671212529841263*^9}, {
  3.6712252503548*^9, 3.671225253595416*^9}, {3.671264539650382*^9, 
  3.671264550641947*^9}, {3.6712849836103363`*^9, 3.671284983936577*^9}}],

Cell[CellGroupData[{

Cell["3.a Get  filenames of all raw images", "Subsection",
 CellChangeTimes->{{3.463681235019806*^9, 3.463681239118738*^9}, {
   3.4636812810301037`*^9, 3.463681353961514*^9}, {3.558808599359791*^9, 
   3.5588086640162354`*^9}, 3.558810235712479*^9, {3.559406394015561*^9, 
   3.559406396863049*^9}, {3.671217685839896*^9, 3.671217686814314*^9}, {
   3.671225176724145*^9, 3.671225179696331*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"filenamesRaw", " ", "=", " ", 
   RowBox[{"FileNames", "[", 
    RowBox[{"\"\<Bullet*\>\"", ",", "pathRawData"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"angleList", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", "filenamesRaw", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"j", "=", "1"}], ",", 
    RowBox[{"j", "\[LessEqual]", " ", 
     RowBox[{"Length", "[", "filenamesRaw", "]"}]}], ",", 
    RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"filename", " ", "=", " ", 
      RowBox[{"Last", "[", 
       RowBox[{"FileNameSplit", "[", 
        RowBox[{"filenamesRaw", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"angleList", "[", 
       RowBox[{"[", "j", "]"}], "]"}], " ", "=", 
      RowBox[{"ToExpression", "[", " ", 
       RowBox[{"Last", "[", 
        RowBox[{"StringSplit", "[", "filename", "]"}], "]"}], "]"}]}], 
     ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"indexList", " ", "=", " ", 
   RowBox[{"Ordering", "[", "angleList", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"angleList", " ", "=", " ", 
   RowBox[{"angleList", "[", 
    RowBox[{"[", "indexList", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filenamesRaw", " ", "=", " ", 
   RowBox[{"filenamesRaw", "[", 
    RowBox[{"[", "indexList", "]"}], "]"}]}], ";", "  ", 
  RowBox[{"Clear", "[", "indexList", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "filenamesRaw", "]"}], "\[IndentingNewLine]", 
 RowBox[{"filenamesRaw", "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"filenamesRaw", "[", 
  RowBox[{"[", 
   RowBox[{"Length", "[", "filenamesRaw", "]"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.463681950376687*^9, 3.4636819919351683`*^9}, {
   3.463689913166922*^9, 3.463689913505628*^9}, {3.463689969011688*^9, 
   3.463689969308107*^9}, {3.558531373257534*^9, 3.558531377021082*^9}, {
   3.5588086783899403`*^9, 3.558808683915753*^9}, {3.5588089385564137`*^9, 
   3.558808964689187*^9}, {3.55881002309833*^9, 3.558810028246389*^9}, {
   3.559409648042592*^9, 3.559409649884472*^9}, 3.569087451257504*^9, {
   3.671217710752445*^9, 3.67121773152995*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
3.b. Make a short table of rotation angles and corresponding filenames\
\>", "Subsection",
 CellChangeTimes->{{3.463681235019806*^9, 3.463681239118738*^9}, {
   3.4636812810301037`*^9, 3.463681353961514*^9}, {3.558808599359791*^9, 
   3.5588086640162354`*^9}, 3.558810235712479*^9, {3.559406394015561*^9, 
   3.559406396863049*^9}, {3.5594080226344023`*^9, 3.5594080421368427`*^9}, {
   3.559408140158431*^9, 3.5594081419410686`*^9}, {3.671225192195108*^9, 
   3.671225209232772*^9}, {3.671225474746367*^9, 3.6712254754978647`*^9}}],

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"angleList", ",", "filenamesRaw"}], "}"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "30"}], "]"}], "]"}], ",", 
   RowBox[{"TableHeadings", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"Automatic", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<angle\>\"", ",", "\"\<filename\>\""}], "}"}]}], "}"}]}]}],
   "]"}]], "Input",
 CellChangeTimes->{{3.559408047024708*^9, 3.559408125655599*^9}, {
   3.559410218775185*^9, 3.559410243069098*^9}, 3.671226857673963*^9, 
   3.671227343086433*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["3.c Read all  * text files and make a movie", "Subsection",
 CellChangeTimes->{{3.463681235019806*^9, 3.463681239118738*^9}, {
   3.4636812810301037`*^9, 3.463681353961514*^9}, {3.559406463204034*^9, 
   3.559406466651513*^9}, 3.5594082591537457`*^9, {3.5594084933084*^9, 
   3.5594084994670143`*^9}, {3.5594093375512133`*^9, 3.559409359077446*^9}, 
   3.559410896501048*^9, {3.559411044089253*^9, 3.55941105048135*^9}, {
   3.6712305044002523`*^9, 3.671230504416504*^9}}],

Cell["We learn that there are two bad frames.", "Text",
 CellChangeTimes->{{3.559414989440118*^9, 3.5594150210888453`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"allImages", " ", "=", 
   RowBox[{"Table", "[", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"raw", " ", "=", 
          RowBox[{"Import", "[", 
           RowBox[{
            RowBox[{"filenamesRaw", "[", 
             RowBox[{"[", "index", "]"}], "]"}], ",", "\"\<Table\>\""}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"gRaw", " ", "=", 
          RowBox[{
           RowBox[{"Image", "[", 
            RowBox[{"raw", ",", "\"\<Bit16\>\""}], "]"}], "//", 
           "ImageAdjust"}]}]}]}], " ", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Show", "[", 
       RowBox[{"gRaw", ",", 
        RowBox[{"Epilog", "->", 
         RowBox[{"Inset", "[", 
          RowBox[{
           RowBox[{"Text", "[", "index", "]"}], ",", 
           RowBox[{"Scaled", "[", 
            RowBox[{"{", 
             RowBox[{"0.1", ",", "0.95"}], "}"}], "]"}], ",", 
           RowBox[{"Background", "\[Rule]", "White"}]}], "]"}]}]}], "]"}]}], 
     ",", " ", 
     RowBox[{"{", 
      RowBox[{"index", ",", "1", ",", " ", 
       RowBox[{"Length", "[", "filenamesRaw", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.559409564680974*^9, 3.5594096016893997`*^9}, {
   3.559409933305408*^9, 3.55940994635594*^9}, {3.559411857744636*^9, 
   3.5594118938171597`*^9}, {3.559412006143607*^9, 3.559412006431005*^9}, {
   3.671227393557045*^9, 3.67122739860077*^9}, {3.6712284249107323`*^9, 
   3.67122845469447*^9}, 3.671228788094639*^9, {3.671228844467207*^9, 
   3.67122886541173*^9}}],

Cell[BoxData[
 RowBox[{"Switch", "[", 
  RowBox[{
  "$OperatingSystem", ",", "\[IndentingNewLine]", "\"\<MacOSX\>\"", ",", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"pathFigures", "<>", "\"\<movie_raw_images.mov\>\""}], ",", " ", 
     "allImages", ",", 
     RowBox[{"\"\<FrameRate\>\"", "\[Rule]", "15"}], ",", 
     RowBox[{"Antialiasing", "\[Rule]", "True"}], ",", 
     RowBox[{
     "\"\<VideoEncoding\>\"", "\[Rule]", 
      "\"\<Apple Intermediate Codec\>\""}]}], "]"}], " ", ",", 
   "\[IndentingNewLine]", "\"\<Windows\>\"", ",", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"pathFigures", "<>", " ", "\"\<movie_raw_images.qt\>\""}], ",", 
     " ", "allImages", ",", 
     RowBox[{"\"\<FrameRate\>\"", "\[Rule]", "15"}]}], "]"}], " ", ",", 
   "\[IndentingNewLine]", "\"\<Unix\>\"", ",", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"pathFigures", "<>", " ", "\"\<movie_raw_images.avi\>\""}], ",", 
     " ", "allImages", ",", 
     RowBox[{"\"\<FrameRate\>\"", "\[Rule]", "15"}]}], "]"}]}], "   ", 
  "]"}]], "Input",
 CellChangeTimes->{{3.6699658622492237`*^9, 3.669965865225535*^9}, {
  3.6712274325340157`*^9, 3.671227441674903*^9}, {3.671227823237356*^9, 
  3.6712278276116953`*^9}, {3.671227876092636*^9, 3.671227899658801*^9}, {
  3.6712284959857492`*^9, 3.671228499011549*^9}, {3.671229060708336*^9, 
  3.671229065384808*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
3.d. Read all raw images and make all attenuation files.  Save as FITS
(about 4 minutes on a laptop)\
\>", "Subsection",
 CellChangeTimes->{{3.463681235019806*^9, 3.463681239118738*^9}, {
   3.4636812810301037`*^9, 3.463681353961514*^9}, {3.559406463204034*^9, 
   3.559406466651513*^9}, 3.5594082591537457`*^9, {3.5594084933084*^9, 
   3.5594084994670143`*^9}, {3.569096534016488*^9, 3.569096539798254*^9}, {
   3.671230431249209*^9, 3.671230437485222*^9}, {3.67123050755593*^9, 
   3.671230517671579*^9}, {3.671257671354135*^9, 3.671257687677436*^9}, {
   3.6712852601410637`*^9, 3.671285275919322*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ParallelTable", "[", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"filename", " ", "=", " ", 
        RowBox[{"Last", "[", 
         RowBox[{"FileNameSplit", "[", 
          RowBox[{"filenamesRaw", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"raw", " ", "=", " ", 
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"filenamesRaw", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", "\"\<Table\>\""}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"raw", "=", 
        RowBox[{"funcFilterRawImages", "[", "raw", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"attenuation", " ", "=", " ", 
        RowBox[{
         RowBox[{"Re", "[", 
          RowBox[{"Log", "[", " ", 
           FractionBox[
            RowBox[{
             RowBox[{"openBeam", "/", "600"}], " ", "-", " ", 
             RowBox[{"dark", "/", "100"}]}], 
            RowBox[{
             RowBox[{"raw", "/", "140"}], "-", " ", 
             RowBox[{"dark", "/", "100"}]}]], "]"}], "]"}], "//", "N"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"airRegion", " ", "=", " ", 
        RowBox[{"MedianFilter", "[", 
         RowBox[{
          RowBox[{"attenuation", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"220", ";;", "NX"}]}], "]"}], "]"}], ",", "1"}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"offset", " ", "=", " ", 
        RowBox[{"Mean", "[", 
         RowBox[{"Flatten", "[", "airRegion", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"attenuation", " ", "=", 
        RowBox[{"attenuation", " ", "-", " ", "offset"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"attenuation", "=", 
        RowBox[{"funcFilterAttenuation", "[", 
         RowBox[{"attenuation", ",", 
          RowBox[{"Max", "[", "grayScalePlotLimits", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"attenuation", " ", "=", 
        RowBox[{"Reverse", "[", 
         RowBox[{"Transpose", "[", " ", "attenuation", "]"}], "]"}]}], ";", 
       "   ", "\[IndentingNewLine]", 
       RowBox[{"filenameFITS", " ", "=", " ", 
        RowBox[{"pathAttenuation", "<>", "\"\<attenuation_#\>\"", "<>", 
         RowBox[{"IntegerString", "[", 
          RowBox[{"j", ",", "10", ",", "4"}], "]"}], "<>", "\"\<_\>\"", "<>", 
         
         RowBox[{"ToString", "[", 
          RowBox[{"angleList", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "]"}], "<>", 
         "\"\<deg.fits\>\""}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"filenameFITS", ",", "attenuation"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"{", 
         RowBox[{"j", ",", "offset", ",", " ", 
          RowBox[{"Min", "[", "attenuation", "]"}], ",", 
          RowBox[{"Mean", "[", 
           RowBox[{"Flatten", "[", "attenuation", "]"}], "]"}], ",", 
          RowBox[{"Max", "[", "attenuation", "]"}]}], "}"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"j", ",", " ", "1", ",", 
      RowBox[{"Length", "[", "filenamesRaw", "]"}], ",", "1"}], "}"}]}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.4592538822789583`*^9, 3.459253928413217*^9}, {
   3.45925410340371*^9, 3.4592541617898273`*^9}, {3.459254196255389*^9, 
   3.459254201400072*^9}, {3.459254289191696*^9, 3.459254392385233*^9}, {
   3.459254439325398*^9, 3.4592544407873096`*^9}, 3.459254663668887*^9, {
   3.45925473151448*^9, 3.459254789913672*^9}, 3.459254868656863*^9, {
   3.4636855104467297`*^9, 3.4636855128787527`*^9}, {3.463689201594097*^9, 
   3.463689205337988*^9}, 3.463689957645792*^9, {3.463689991317563*^9, 
   3.4636900209779787`*^9}, {3.463690259420066*^9, 3.4636902711614933`*^9}, {
   3.4636905374322653`*^9, 3.463690656038171*^9}, {3.4636907942120943`*^9, 
   3.463690794514735*^9}, {3.4636956862626867`*^9, 3.463695690237155*^9}, {
   3.463695769698773*^9, 3.463695785771739*^9}, {3.4636959317417583`*^9, 
   3.4636959605634336`*^9}, {3.4636964400578547`*^9, 
   3.4636964770235157`*^9}, {3.558532127875326*^9, 3.5585321302950497`*^9}, {
   3.558532208157119*^9, 3.558532228517769*^9}, {3.558532295623022*^9, 
   3.558532391936315*^9}, {3.558532690782543*^9, 3.558532731781416*^9}, {
   3.5587217142256413`*^9, 3.5587217144476023`*^9}, {3.5588081396901484`*^9, 
   3.5588081469267673`*^9}, {3.558891184718149*^9, 3.5588911934929667`*^9}, {
   3.559403139796494*^9, 3.559403139805093*^9}, {3.559403354646017*^9, 
   3.559403354653853*^9}, {3.559407115473885*^9, 3.559407115776354*^9}, {
   3.559408313152308*^9, 3.559408315738258*^9}, {3.559408346183473*^9, 
   3.559408349795107*^9}, {3.559408913800168*^9, 3.559408922624544*^9}, 
   3.559408998076634*^9, {3.559409292940496*^9, 3.559409314198979*^9}, {
   3.559410151948265*^9, 3.5594101621808777`*^9}, {3.559410416195291*^9, 
   3.559410423271955*^9}, {3.5594159348660383`*^9, 3.559415937447936*^9}, {
   3.5690962401038713`*^9, 3.56909624709718*^9}, 3.569097103758308*^9, {
   3.671230455609976*^9, 3.6712304785301237`*^9}, {3.671230587867622*^9, 
   3.671230713416265*^9}, {3.671230813845694*^9, 3.671230828221169*^9}, {
   3.67123101712187*^9, 3.671231125274382*^9}, 3.671231333638569*^9, {
   3.671231401506488*^9, 3.6712314145035343`*^9}, {3.67123154748211*^9, 
   3.671231568451429*^9}, {3.671231721391033*^9, 3.671231726199423*^9}, {
   3.671231811157193*^9, 3.671231854387678*^9}, {3.67123190190121*^9, 
   3.671231926212944*^9}, {3.671232049175462*^9, 3.6712320557159977`*^9}, {
   3.671232114968358*^9, 3.671232123348155*^9}, 3.671232163732995*^9, {
   3.671232234451435*^9, 3.671232264937446*^9}, 3.671232339199765*^9, 
   3.671232396313748*^9, {3.6712565829864893`*^9, 3.671256587450841*^9}, {
   3.6712569331946*^9, 3.671256976878986*^9}, {3.671257129483487*^9, 
   3.671257141962232*^9}, {3.671257335794353*^9, 3.6712573413091593`*^9}, {
   3.671258132744779*^9, 3.6712581644850883`*^9}, 3.671258483926496*^9, {
   3.67125956728115*^9, 3.671259578340646*^9}, {3.671260019918787*^9, 
   3.671260027501404*^9}, {3.671260110105871*^9, 3.671260138448319*^9}, 
   3.671260493010816*^9, {3.671261784810824*^9, 3.671261802583674*^9}, {
   3.671262108182233*^9, 3.6712621522218018`*^9}, {3.671262649588419*^9, 
   3.6712627419821577`*^9}, 3.671274840958352*^9, {3.671285504005652*^9, 
   3.6712855464707317`*^9}, {3.671288016380138*^9, 3.671288025607853*^9}, {
   3.671288060193624*^9, 3.671288065299679*^9}, {3.671288439802742*^9, 
   3.671288442777648*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
3.e Replace bad FITS files at #22 and #46 with the average of the neighboring \
data files\
\>", "Subsection",
 CellChangeTimes->{{3.463681235019806*^9, 3.463681239118738*^9}, {
   3.4636812810301037`*^9, 3.463681353961514*^9}, {3.559406463204034*^9, 
   3.559406466651513*^9}, 3.5594082591537457`*^9, {3.5594084933084*^9, 
   3.5594084994670143`*^9}, {3.5594093375512133`*^9, 3.559409359077446*^9}, {
   3.569096873316293*^9, 3.569096877066113*^9}, {3.569096995186625*^9, 
   3.5690969973291492`*^9}, {3.671232685078713*^9, 3.671232693397242*^9}, {
   3.671233165153324*^9, 3.671233201050221*^9}, {3.6712332999192038`*^9, 
   3.671233305162016*^9}, {3.6712338000780087`*^9, 3.6712338156472178`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"j", "=", "22"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filenameFITS", "=", " ", 
   RowBox[{"FileNames", "[", 
    RowBox[{"\"\<attenuation_#*.fits\>\"", ",", "pathAttenuation"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"attenuationReplace", " ", "=", " ", 
    RowBox[{
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"filenameFITS", "[", 
           RowBox[{"[", 
            RowBox[{"j", "-", "1"}], "]"}], "]"}], ",", "\"\<RawData\>\""}], 
         " ", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "+", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"filenameFITS", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "1"}], "]"}], "]"}], ",", "\"\<RawData\>\""}], 
         "  ", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", "2"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"ArrayPlot", "[", 
    RowBox[{"attenuationReplace", ",", 
     RowBox[{"ImageSize", "\[Rule]", "200"}]}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filenameFITS", " ", "=", " ", 
   RowBox[{"pathAttenuation", "<>", "\"\<attenuation_#\>\"", "<>", 
    RowBox[{"IntegerString", "[", 
     RowBox[{"j", ",", "10", ",", "4"}], "]"}], "<>", "\"\<_\>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"angleList", "[", 
      RowBox[{"[", "j", "]"}], "]"}], "]"}], "<>", "\"\<deg.fits\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"filenameFITS", ",", "attenuationReplace"}], "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.671233355962579*^9, 3.67123341893475*^9}, {
   3.671233456878389*^9, 3.671233459028633*^9}, {3.67123348960563*^9, 
   3.671233571197316*^9}, {3.671233627899898*^9, 3.671233639026936*^9}, {
   3.6712337092987213`*^9, 3.6712337706024513`*^9}, {3.671233839079611*^9, 
   3.6712338803098*^9}, {3.6712853002510777`*^9, 3.671285302633355*^9}, {
   3.67128555063022*^9, 3.671285558730699*^9}, 3.671285793775429*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"j", "=", "46"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filenameFITS", "=", " ", 
   RowBox[{"FileNames", "[", 
    RowBox[{"\"\<attenuation_#*.fits\>\"", ",", "pathAttenuation"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"attenuationReplace", " ", "=", " ", 
    RowBox[{
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"filenameFITS", "[", 
           RowBox[{"[", 
            RowBox[{"j", "-", "1"}], "]"}], "]"}], ",", "\"\<RawData\>\""}], 
         " ", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "+", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"filenameFITS", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "1"}], "]"}], "]"}], ",", "\"\<RawData\>\""}], 
         "  ", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", "2"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"ArrayPlot", "[", 
    RowBox[{"attenuationReplace", ",", 
     RowBox[{"ImageSize", "\[Rule]", "200"}]}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filenameFITS", " ", "=", " ", 
   RowBox[{"pathAttenuation", "<>", "\"\<attenuation_#\>\"", "<>", 
    RowBox[{"IntegerString", "[", 
     RowBox[{"j", ",", "10", ",", "4"}], "]"}], "<>", "\"\<_\>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"angleList", "[", 
      RowBox[{"[", "j", "]"}], "]"}], "]"}], "<>", "\"\<deg.fits\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"filenameFITS", ",", "attenuationReplace"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.671233789922159*^9, 3.671233790079277*^9}, {
   3.671233862827527*^9, 3.671233885333415*^9}, {3.6712853053297787`*^9, 
   3.671285306057652*^9}, {3.671285557258855*^9, 3.671285560218793*^9}, 
   3.671285797150837*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["3.f. Read all absorption FITS.  Create *.png", "Subsection",
 CellChangeTimes->{{3.463681235019806*^9, 3.463681239118738*^9}, {
   3.4636812810301037`*^9, 3.463681353961514*^9}, {3.559406463204034*^9, 
   3.559406466651513*^9}, 3.5594082591537457`*^9, {3.5594084933084*^9, 
   3.5594084994670143`*^9}, {3.569096534016488*^9, 3.569096539798254*^9}, {
   3.671230431249209*^9, 3.671230437485222*^9}, {3.67123050755593*^9, 
   3.671230517671579*^9}, {3.671257671354135*^9, 3.671257687677436*^9}, {
   3.671257726103092*^9, 3.671257750942945*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"filenameFITS", "=", " ", 
   RowBox[{"FileNames", "[", 
    RowBox[{"\"\<attenuation_#*.fits\>\"", ",", "pathAttenuation"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"attenuation", " ", "=", "  ", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{
           RowBox[{"filenameFITS", "[", 
            RowBox[{"[", "j", "]"}], "]"}], ",", "\"\<RawData\>\""}], " ", 
          "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"filenamePNG", " ", "=", " ", 
        RowBox[{"pathFigures", "<>", "\"\<attenuation_#\>\"", "<>", 
         RowBox[{"IntegerString", "[", 
          RowBox[{"j", ",", "10", ",", "4"}], "]"}], "<>", "\"\<_\>\"", "<>", 
         
         RowBox[{"ToString", "[", 
          RowBox[{"angleList", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "]"}], "<>", "\"\<deg.png\>\""}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"gAttenuation", "=", " ", 
        RowBox[{"ArrayPlot", "[", 
         RowBox[{"attenuation", ",", 
          RowBox[{"PlotRange", "->", "grayScalePlotLimits"}], ",", 
          RowBox[{"ClippingStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"White", ",", "Black"}], "}"}]}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"FrameTicks", "\[Rule]", "True"}], ",", " ", 
          RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "NY"}], ",", " ", 
          RowBox[{"ColorFunction", "\[Rule]", "\"\<GrayTones\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PlotLegends", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Placed", "[", 
             RowBox[{
              RowBox[{"BarLegend", "[", 
               RowBox[{"{", 
                RowBox[{"\"\<GrayTones\>\"", ",", "grayScalePlotLimits"}], 
                "}"}], "]"}], ",", "Right"}], "]"}], "}"}]}], ",", 
          RowBox[{"Epilog", "\[Rule]", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"angleList", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "<>", 
                 "\"\<\[Degree]\>\""}], ",", "24", ",", "Blue"}], "]"}], 
              "]"}], ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.2", ",", "0.9"}], "}"}], "]"}]}], "]"}]}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"filenamePNG", ",", "gAttenuation"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"j", ",", " ", 
      RowBox[{"Length", "[", "filenameFITS", "]"}]}], "}"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.671257450696568*^9, 3.6712575930139236`*^9}, 
   3.6712584363440037`*^9, {3.671264463197301*^9, 3.6712644781487207`*^9}, 
   3.6712745891599207`*^9, {3.6712855737815733`*^9, 3.671285585656402*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["3.g Read all  *.png and make a movie (about 10 seconds)", "Subsection",
 CellChangeTimes->{{3.463681235019806*^9, 3.463681239118738*^9}, {
   3.4636812810301037`*^9, 3.463681353961514*^9}, {3.559406463204034*^9, 
   3.559406466651513*^9}, 3.5594082591537457`*^9, {3.5594084933084*^9, 
   3.5594084994670143`*^9}, {3.5594093375512133`*^9, 3.559409359077446*^9}, {
   3.569096873316293*^9, 3.569096877066113*^9}, {3.569096995186625*^9, 
   3.5690969973291492`*^9}, {3.671232685078713*^9, 3.671232693397242*^9}, 
   3.671233165153324*^9, 3.6712577579392977`*^9}],

Cell[BoxData[
 RowBox[{"Timing", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"filenamesPNG", "=", " ", 
    RowBox[{"FileNames", "[", 
     RowBox[{"\"\<attenuation_#*\>\"", ",", "pathFigures"}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"indexList", " ", "=", " ", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", 
      RowBox[{"Length", "[", "filenamesPNG", "]"}]}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"j", "=", "1"}], ",", 
     RowBox[{"j", "\[LessEqual]", " ", 
      RowBox[{"Length", "[", "filenamesPNG", "]"}]}], ",", 
     RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"filename", " ", "=", " ", 
       RowBox[{"Last", "[", 
        RowBox[{"FileNameSplit", "[", 
         RowBox[{"filenamesPNG", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"indexList", "[", 
        RowBox[{"[", "j", "]"}], "]"}], " ", "=", 
       RowBox[{"ToExpression", "[", " ", 
        RowBox[{
         RowBox[{"StringSplit", "[", 
          RowBox[{"filename", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<#\>\"", ",", "\"\<_\>\""}], "}"}]}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
   RowBox[{"indexList", " ", "=", " ", 
    RowBox[{"Ordering", "[", "indexList", "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"filenamesPNG", " ", "=", " ", 
    RowBox[{"filenamesPNG", "[", 
     RowBox[{"[", "indexList", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"allImages", " ", "=", 
    RowBox[{"Table", "[", " ", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{"filenamesPNG", "[", 
        RowBox[{"[", "index", "]"}], "]"}], " ", "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"index", ",", "1", ",", " ", 
        RowBox[{"Length", "[", "filenamesPNG", "]"}]}], "}"}]}], "]"}]}], ";",
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Switch", "[", 
    RowBox[{
    "$OperatingSystem", ",", "\[IndentingNewLine]", "\"\<MacOSX\>\"", ",", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"pathFigures", "<>", "\"\<movie_attenuation_images.mov\>\""}], 
       ",", " ", "allImages", ",", 
       RowBox[{"\"\<FrameRate\>\"", "\[Rule]", "15"}]}], "]"}], " ", ",", 
     "\[IndentingNewLine]", "\"\<Windows\>\"", ",", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{
       "pathFigures", "<>", " ", "\"\<movie_attenuation_images.qt\>\""}], ",",
        " ", "allImages", ",", 
       RowBox[{"\"\<FrameRate\>\"", "\[Rule]", "15"}]}], "]"}], "  ", ",", 
     "\[IndentingNewLine]", "\"\<Unix\>\"", ",", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{
       "pathFigures", "<>", " ", "\"\<movie_attenuation_images.avi\>\""}], 
       ",", " ", "allImages", ",", 
       RowBox[{"\"\<FrameRate\>\"", "\[Rule]", "15"}]}], "]"}]}], "   ", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.559409393027544*^9, 3.559409440483016*^9}, {
   3.5594094845663147`*^9, 3.55940951536068*^9}, {3.559409615129059*^9, 
   3.559409702700273*^9}, {3.559409737683379*^9, 3.559409775746293*^9}, {
   3.5594099032535686`*^9, 3.559409931039287*^9}, {3.5690965696008368`*^9, 
   3.569096589970495*^9}, 3.569096739089827*^9, {3.569096924897614*^9, 
   3.569096937368766*^9}, {3.669965896887931*^9, 3.6699659212304707`*^9}, {
   3.6712328825423107`*^9, 3.671232914951634*^9}, 3.671232950217093*^9, {
   3.671232991052307*^9, 3.671233022677209*^9}, 3.6712330571060534`*^9, {
   3.6712855969336863`*^9, 3.67128560719009*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["3.g DumpSave", "Subsection",
 CellChangeTimes->{{3.671211179812208*^9, 3.671211200099522*^9}, {
   3.671211329699849*^9, 3.671211387716975*^9}, 3.6712140481610613`*^9, {
   3.6712166499891567`*^9, 3.671216651875024*^9}, 3.6712339364194517`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DumpSave", "[", 
   RowBox[{
    RowBox[{"pathRoot", "<>", "\"\<step_3.mx\>\""}], ",", 
    RowBox[{"{", "angleList", "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]}], "Input",
 CellChangeTimes->{{3.670170487070524*^9, 3.670170492548648*^9}, {
   3.670170608253581*^9, 3.6701706092764063`*^9}, {3.671216602745532*^9, 
   3.671216611939556*^9}, {3.6712166842956038`*^9, 3.671216690287579*^9}, 
   3.671216778684046*^9, 3.671217190175748*^9, {3.6712253696102533`*^9, 
   3.671225371499885*^9}, {3.67123037984468*^9, 3.671230387994924*^9}, {
   3.67123393979906*^9, 3.6712339674821463`*^9}, 3.6712856119170523`*^9}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Step 4. Make sinograms (2 minutes)", "Section",
 CellChangeTimes->{{3.4562833726280527`*^9, 3.456283385607916*^9}, {
   3.463555031609515*^9, 3.463555047770688*^9}, 3.463590933610998*^9, 
   3.463591573151423*^9, {3.463681205490497*^9, 3.463681218422361*^9}, {
   3.463723051179096*^9, 3.463723089887204*^9}, {3.463723208493277*^9, 
   3.463723230746255*^9}, {3.4637256437176247`*^9, 3.463725653299542*^9}, {
   3.4637352447475653`*^9, 3.4637352458973846`*^9}, {3.55941630259121*^9, 
   3.559416305212385*^9}, {3.5691432899551973`*^9, 3.569143294102618*^9}, 
   3.671294285339218*^9}],

Cell[BoxData[{
 RowBox[{"pathRoot", " ", "=", " ", 
  "\"\</melete-nas01/lsu/scratch/BulletData/\>\""}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", 
  RowBox[{"pathRoot", "<>", "\"\<step_1.mx\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", 
  RowBox[{"pathRoot", "<>", "\"\<step_2.mx\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", 
  RowBox[{"pathRoot", "<>", "\"\<step_3.mx\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.6712125294719152`*^9, 3.671212529841263*^9}, {
  3.6712252503548*^9, 3.671225253595416*^9}, {3.6712339930909777`*^9, 
  3.6712339963913193`*^9}}],

Cell[CellGroupData[{

Cell["4.a  Read all attenuation FITS and make allSinograms ", "Subsection",
 CellChangeTimes->{{3.4562833726280527`*^9, 3.456283385607916*^9}, {
   3.463555031609515*^9, 3.463555047770688*^9}, 3.463590933610998*^9, 
   3.463591573151423*^9, {3.463681205490497*^9, 3.463681218422361*^9}, {
   3.463723051179096*^9, 3.463723089887204*^9}, {3.463723208493277*^9, 
   3.463723230746255*^9}, {3.558538088340563*^9, 3.558538107308223*^9}, {
   3.559416317605693*^9, 3.559416321556931*^9}, {3.559416735103908*^9, 
   3.559416737301735*^9}, {3.6712340331354647`*^9, 3.671234065158613*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"filenameFITS", " ", "=", " ", 
   RowBox[{"FileNames", "[", 
    RowBox[{"\"\<attenuation_#*.fits\>\"", ",", "pathAttenuation"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "filenameFITS", "]"}]}], "Input",
 CellChangeTimes->{
  3.463723317906293*^9, {3.46372357722439*^9, 3.4637236270473337`*^9}, {
   3.463723764104*^9, 3.4637237916571608`*^9}, {3.558533302223468*^9, 
   3.55853333475248*^9}, 3.55853354513911*^9, {3.558533585388596*^9, 
   3.558533633078586*^9}, {3.558533702674754*^9, 3.5585337214906883`*^9}, {
   3.558533772307551*^9, 3.558533772897843*^9}, {3.558534291390914*^9, 
   3.558534291785593*^9}, {3.55853643267446*^9, 3.5585364362661552`*^9}, {
   3.558536472684112*^9, 3.558536476603812*^9}, {3.558536567667124*^9, 
   3.5585365708990383`*^9}, 3.569097153381545*^9, {3.671234051653967*^9, 
   3.671234085187051*^9}, {3.671234134072135*^9, 3.6712341350399647`*^9}, {
   3.6712342639354258`*^9, 3.671234301700996*^9}, {3.671234467337297*^9, 
   3.671234468454912*^9}, {3.671234696087525*^9, 3.671234696438366*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"NZ", " ", "=", " ", 
   RowBox[{
    RowBox[{"Length", "[", "filenameFITS", "]"}], "-", "1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allSinograms", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"NY", ",", "NX", ",", "NZ"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "allSinograms", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"projection", " ", "=", "1"}], ",", 
    RowBox[{"projection", "\[LessEqual]", " ", "NZ"}], ",", 
    RowBox[{"projection", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"attenuation", " ", "=", " ", 
      RowBox[{
       RowBox[{"Import", "[", 
        RowBox[{
         RowBox[{"filenameFITS", "[", 
          RowBox[{"[", "projection", "]"}], "]"}], ",", "\"\<RawData\>\""}], 
        " ", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"allSinograms", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "All", ",", "projection"}], "]"}], "]"}], "=", 
      "attenuation"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "allSinograms", "]"}]}], "Input",
 CellChangeTimes->{{3.671234320356866*^9, 3.671234437559785*^9}, 
   3.671234702093828*^9, {3.67127539539709*^9, 3.671275398121792*^9}, {
   3.671285631227914*^9, 3.671285631834198*^9}, {3.6712899470813828`*^9, 
   3.671289949160776*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"indexSlice", " ", "=", " ", "165"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gSino", "=", 
   RowBox[{"ArrayPlot", "[", " ", 
    RowBox[{
     RowBox[{"allSinograms", "[", 
      RowBox[{"[", 
       RowBox[{"indexSlice", ",", "All", ",", "All"}], "]"}], "]"}], ",", " ",
      "\[IndentingNewLine]", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"All", ",", "All", ",", "grayScalePlotLimits"}], "}"}]}], ",", 
     
     RowBox[{"ColorFunction", "\[Rule]", "\"\<TemperatureMap\>\""}], ",", 
     RowBox[{"ClippingStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Black", ",", "White"}], "}"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<\[Theta], degrees\>\"", ",", 
          RowBox[{"\"\<slice = \>\"", "<>", 
           RowBox[{"ToString", "[", "indexSlice", "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<columns\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Placed", "[", 
        RowBox[{
         RowBox[{"BarLegend", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<TemperatureMap\>\"", ",", "grayScalePlotLimits"}], 
            "}"}], ",", 
           RowBox[{"LegendMarkerSize", "\[Rule]", "150"}]}], "]"}], ",", 
         "Right"}], "]"}], "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lineProbe", " ", "=", 
   RowBox[{"allSinograms", "[", 
    RowBox[{"[", 
     RowBox[{"indexSlice", ",", 
      RowBox[{"{", 
       RowBox[{"30", ",", "120"}], "}"}], ",", "All"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gLineProbe", "=", 
   RowBox[{"ListPlot", "[", 
    RowBox[{"lineProbe", ",", " ", 
     RowBox[{"PlotRange", "\[Rule]", "grayScalePlotLimits"}], ",", " ", 
     RowBox[{"AxesOrigin", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<attenuation\>\"", ",", "\"\<\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<\[Theta], degrees\>\"", ",", "\"\<columns 20, 120\>\""}], 
         "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"GridLines", "\[Rule]", "Automatic"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"GraphicsRow", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"gSino", ",", "gLineProbe"}], "}"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "700"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.459280374557766*^9, 3.459280410884424*^9}, {
   3.459280675395046*^9, 3.459280743320352*^9}, {3.459284168661813*^9, 
   3.459284195262405*^9}, {3.459284246841783*^9, 3.459284259639557*^9}, {
   3.459284329263711*^9, 3.459284332742413*^9}, {3.463723883550887*^9, 
   3.463723897895046*^9}, {3.463735054620751*^9, 3.4637350548186007`*^9}, {
   3.558534371026425*^9, 3.558534435980426*^9}, {3.558535891417568*^9, 
   3.5585359287133904`*^9}, 3.5585360029037037`*^9, {3.5585360373184843`*^9, 
   3.558536100648546*^9}, {3.558536132002379*^9, 3.558536270464951*^9}, {
   3.558536344445058*^9, 3.558536374309331*^9}, {3.5585371638772993`*^9, 
   3.558537192658821*^9}, {3.67128606695238*^9, 3.6712862223905163`*^9}, {
   3.671286269838119*^9, 3.671286415363947*^9}, {3.6712864494529037`*^9, 
   3.6712864544230833`*^9}, {3.6712865664956284`*^9, 3.6712865953888597`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["4.b. Find best center of rotation", "Subsection",
 CellChangeTimes->{{3.4562833726280527`*^9, 3.456283385607916*^9}, {
   3.463555031609515*^9, 3.463555047770688*^9}, 3.463590933610998*^9, 
   3.463591573151423*^9, {3.463681205490497*^9, 3.463681218422361*^9}, {
   3.463723051179096*^9, 3.463723089887204*^9}, {3.463723208493277*^9, 
   3.463723230746255*^9}, {3.558538088340563*^9, 3.558538132773198*^9}, {
   3.558539022074757*^9, 3.5585390331694403`*^9}, {3.558539974016464*^9, 
   3.558539982679241*^9}, {3.559416785274221*^9, 3.5594167877756977`*^9}, {
   3.6712905416584177`*^9, 3.671290542262269*^9}, {3.67129057424026*^9, 
   3.671290575712109*^9}, 3.671293124532455*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"index0deg", "=", 
   RowBox[{"First", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Position", "[", 
      RowBox[{"angleList", ",", 
       RowBox[{"p_", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#", ">=", "0"}], "&"}], ")"}]}]}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"index180deg", "=", 
   RowBox[{"Last", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Position", "[", 
      RowBox[{"angleList", ",", 
       RowBox[{"p_", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#", "<=", "180"}], "&"}], ")"}]}]}], "]"}], "]"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filenameFITS", " ", "=", " ", 
   RowBox[{"FileNames", "[", 
    RowBox[{"\"\<attenuation_#*.fits\>\"", ",", "pathAttenuation"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"attenuation0Deg", " ", "=", " ", 
   RowBox[{"ImageAdjust", "[", 
    RowBox[{"Image", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Import", "[", 
        RowBox[{
         RowBox[{"filenameFITS", "[", 
          RowBox[{"[", "index0deg", "]"}], "]"}], ",", "\"\<RawData\>\""}], 
        " ", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<Real\>\""}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"attenuation180Deg", " ", "=", " ", 
   RowBox[{"ImageAdjust", "[", 
    RowBox[{"Image", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Import", "[", 
        RowBox[{
         RowBox[{"filenameFITS", "[", 
          RowBox[{"[", "index180deg", "]"}], "]"}], ",", "\"\<RawData\>\""}], 
        " ", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<Real\>\""}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"transformationFunction", " ", "=", " ", 
  RowBox[{"FindGeometricTransform", "[", 
   RowBox[{"attenuation0Deg", ",", 
    RowBox[{"ImageReflect", "[", 
     RowBox[{"attenuation180Deg", ",", 
      RowBox[{"Left", "\[Rule]", "Right"}]}], "]"}], ",", 
    RowBox[{"TransformationClass", "\[Rule]", "\"\<Translation\>\""}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"estimatedCenteringShift", " ", "=", " ", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"transformationFunction", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "1", ",", "1", ",", "3"}], "]"}], "]"}], "/", "2"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.671287819436809*^9, 3.6712879577225924`*^9}, {
  3.671289760376684*^9, 3.671289773580069*^9}, {3.671290674671102*^9, 
  3.67129068589456*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sinogram", "=", " ", 
    RowBox[{"allSinograms", "[", 
     RowBox[{"[", 
      RowBox[{"indexSlice", ",", "All", ",", "All"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gCenteringTest", " ", "=", " ", 
    RowBox[{"ParallelTable", "[", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"imageSlice", " ", "=", " ", 
          RowBox[{"InverseRadon", "[", 
           RowBox[{"Image", "[", 
            RowBox[{
             RowBox[{"funcShiftSinogram", "[", 
              RowBox[{"sinogram", ",", "shift", ",", "NY", ",", "NZ"}], "]"}],
              ",", "\"\<Real\>\""}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"g1", "  ", "=", " ", 
          RowBox[{"ImageAdjust", "[", " ", 
           RowBox[{"ImageResize", "[", 
            RowBox[{"imageSlice", ",", "400"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", 
          RowBox[{"g1", ",", 
           RowBox[{"Epilog", "\[Rule]", 
            RowBox[{"Inset", "[", 
             RowBox[{
              RowBox[{"Text", "[", 
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"\"\<shift = \>\"", "<>", 
                  RowBox[{"ToString", "[", "shift", "]"}]}], ",", "20", ",", 
                 RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], "]"}], 
              ",", 
              RowBox[{"Scaled", "[", 
               RowBox[{"{", 
                RowBox[{"0.8", ",", "0.8"}], "}"}], "]"}]}], "]"}]}]}], 
          "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"shift", ",", 
        RowBox[{"estimatedCenteringShift", "+", 
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1", ",", "1"}], "]"}]}]}], "}"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"GraphicsColumn", "[", "gCenteringTest", "]"}]}], "Input",
 CellChangeTimes->{{3.6712900756971827`*^9, 3.671290087168082*^9}, {
  3.671290155194151*^9, 3.67129019050135*^9}, {3.671290227225786*^9, 
  3.671290249412715*^9}, {3.671290302758904*^9, 3.671290307043273*^9}, {
  3.6712906239838533`*^9, 3.6712906303159323`*^9}, {3.6712907057236567`*^9, 
  3.671290728275056*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["4.c  Shift all sinograms and plot a few reconstructions", "Subsection",
 CellChangeTimes->{{3.4562833726280527`*^9, 3.456283385607916*^9}, {
   3.463555031609515*^9, 3.463555047770688*^9}, 3.463590933610998*^9, 
   3.463591573151423*^9, {3.463681205490497*^9, 3.463681218422361*^9}, {
   3.463723051179096*^9, 3.463723089887204*^9}, {3.463723208493277*^9, 
   3.463723230746255*^9}, {3.558538088340563*^9, 3.558538132773198*^9}, {
   3.558539022074757*^9, 3.5585390331694403`*^9}, {3.558539215068102*^9, 
   3.558539227817025*^9}, {3.5594168311336393`*^9, 3.5594168404577312`*^9}, {
   3.671290589361055*^9, 3.6712905899849977`*^9}, {3.671291698190036*^9, 
   3.671291698753819*^9}, {3.671291737430192*^9, 3.671291746540285*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"bestShift", " ", "=", "estimatedCenteringShift"}], ";"}]], "Input",\

 CellChangeTimes->{{3.671291088852418*^9, 3.671291092523012*^9}, 
   3.671291702410961*^9}],

Cell[BoxData[{
 RowBox[{"Dimensions", "[", "allSinograms", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"indexSlice", " ", "=", "1"}], ",", " ", 
    RowBox[{"indexSlice", "\[LessEqual]", "NX"}], ",", 
    RowBox[{"indexSlice", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sinogram", "=", " ", 
      RowBox[{"allSinograms", "[", 
       RowBox[{"[", 
        RowBox[{"indexSlice", ",", "All", ",", "All"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sinogram", "=", 
      RowBox[{"funcStreakRemovalFFT", "[", 
       RowBox[{"sinogram", ",", "0.5"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"sinogram", "=", " ", 
      RowBox[{"funcUseAirRegionForOffsetSinogram", "[", 
       RowBox[{"sinogram", ",", "5"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sinogram", " ", "=", 
      RowBox[{"funcShiftSinogram", "[", 
       RowBox[{"sinogram", ",", "bestShift", " ", ",", "NY", ",", "NZ"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"allSinograms", "[", 
       RowBox[{"[", 
        RowBox[{"indexSlice", ",", "All", ",", "All"}], "]"}], "]"}], "=", 
      "sinogram"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.671291017089218*^9, 3.671291041880803*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gSeveralSlices", "=", " ", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sinogram", "=", " ", 
         RowBox[{"allSinograms", "[", 
          RowBox[{"[", 
           RowBox[{"indexSlice", ",", "All", ",", "All"}], "]"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"imageSlice", " ", "=", " ", 
         RowBox[{"InverseRadon", "[", 
          RowBox[{"Image", "[", 
           RowBox[{"sinogram", ",", "\"\<Real\>\""}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"g1", "  ", "=", " ", 
         RowBox[{"ImageAdjust", "[", " ", 
          RowBox[{"ImageResize", "[", 
           RowBox[{"imageSlice", ",", "400"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Show", "[", 
         RowBox[{"g1", ",", 
          RowBox[{"Epilog", "\[Rule]", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"\"\<slice = \>\"", "<>", 
                 RowBox[{"ToString", "[", "indexSlice", "]"}]}], ",", "20", 
                ",", 
                RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], "]"}], 
             ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.8", ",", "0.8"}], "}"}], "]"}]}], "]"}]}]}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"indexSlice", ",", 
       RowBox[{"Range", "[", 
        RowBox[{"40", ",", "NX", ",", "50"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"GraphicsColumn", "[", "gSeveralSlices", "]"}]}], "Input",
 CellChangeTimes->{{3.6712911327431927`*^9, 3.671291203057275*^9}, {
  3.6712912652652483`*^9, 3.671291277840612*^9}, {3.671291804786152*^9, 
  3.671291805248163*^9}, {3.671293782878566*^9, 3.6712937829412727`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["4.d  Save sinograms as FITS files", "Subsection",
 CellChangeTimes->{{3.4562833726280527`*^9, 3.456283385607916*^9}, {
   3.463555031609515*^9, 3.463555047770688*^9}, 3.463590933610998*^9, 
   3.463591573151423*^9, {3.463681205490497*^9, 3.463681218422361*^9}, {
   3.463723051179096*^9, 3.463723089887204*^9}, {3.463723208493277*^9, 
   3.463723230746255*^9}, {3.558538088340563*^9, 3.558538132773198*^9}, {
   3.558539022074757*^9, 3.5585390331694403`*^9}, {3.558539215068102*^9, 
   3.558539227817025*^9}, {3.5594168311336393`*^9, 3.5594168404577312`*^9}, {
   3.671290589361055*^9, 3.6712905899849977`*^9}, {3.671291698190036*^9, 
   3.671291698753819*^9}, {3.671291757028778*^9, 3.671291764820984*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sinogram", "=", " ", 
        RowBox[{"allSinograms", "[", 
         RowBox[{"[", 
          RowBox[{"indexSlice", ",", "All", ",", "All"}], "]"}], "]"}]}], ";", 
       RowBox[{"filenameFITS", " ", "=", " ", 
        RowBox[{"pathSinograms", "<>", "\"\<sinogram_#\>\"", "<>", 
         RowBox[{"IntegerString", "[", 
          RowBox[{"indexSlice", ",", "10", ",", "4"}], "]"}], "<>", 
         "\"\<.fits\>\""}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"filenameFITS", ",", "sinogram"}], "]"}], ";"}]}], " ", 
     "\[IndentingNewLine]", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"indexSlice", ",", "NX"}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.671291463610992*^9, 3.671291492615631*^9}, {
   3.671291642505212*^9, 3.6712916436875772`*^9}, {3.671291783930653*^9, 
   3.6712917987436123`*^9}, 3.67129183097085*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["4.e DumpSave", "Subsection",
 CellChangeTimes->{{3.671211179812208*^9, 3.671211200099522*^9}, {
   3.671211329699849*^9, 3.671211387716975*^9}, 3.6712140481610613`*^9, {
   3.6712166499891567`*^9, 3.671216651875024*^9}, 3.6712339364194517`*^9, {
   3.671292024332885*^9, 3.67129202528258*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DumpSave", "[", 
   RowBox[{
    RowBox[{"pathRoot", "<>", "\"\<step_4.mx\>\""}], ",", 
    RowBox[{"{", 
     RowBox[{"angleList", ",", "bestShift", ",", "estimatedCenteringShift"}], 
     "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]}], "Input",
 CellChangeTimes->{{3.670170487070524*^9, 3.670170492548648*^9}, {
   3.670170608253581*^9, 3.6701706092764063`*^9}, {3.671216602745532*^9, 
   3.671216611939556*^9}, {3.6712166842956038`*^9, 3.671216690287579*^9}, 
   3.671216778684046*^9, 3.671217190175748*^9, {3.6712253696102533`*^9, 
   3.671225371499885*^9}, {3.67123037984468*^9, 3.671230387994924*^9}, {
   3.67123393979906*^9, 3.6712339674821463`*^9}, 3.6712856119170523`*^9, 
   3.671292033107594*^9, {3.671293685844124*^9, 3.671293688322413*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Step 5. Reconstruct the sinograms into slices (1 minute). 
Save slices as FITS. Save volume as HDF5.\
\>", "Section",
 CellChangeTimes->{{3.4562833726280527`*^9, 3.456283385607916*^9}, {
   3.463555031609515*^9, 3.463555047770688*^9}, 3.463590933610998*^9, 
   3.463591573151423*^9, {3.463681205490497*^9, 3.463681218422361*^9}, {
   3.463723051179096*^9, 3.463723089887204*^9}, {3.463723208493277*^9, 
   3.463723230746255*^9}, {3.4637256437176247`*^9, 3.463725653299542*^9}, {
   3.4637352447475653`*^9, 3.4637352458973846`*^9}, {3.558540001458095*^9, 
   3.558540011840509*^9}, {3.558540784960745*^9, 3.558540813128832*^9}, {
   3.5594169078547897`*^9, 3.559416910820979*^9}, {3.569143299596472*^9, 
   3.569143315252818*^9}, {3.671293064656342*^9, 3.671293097841214*^9}, {
   3.671294309071406*^9, 3.671294310303315*^9}, {3.671294857606304*^9, 
   3.671294878508099*^9}}],

Cell[BoxData[{
 RowBox[{"pathRoot", " ", "=", " ", 
  "\"\</melete-nas01/lsu/scratch/BulletData/\>\""}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", 
  RowBox[{"pathRoot", "<>", "\"\<step_1.mx\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", 
  RowBox[{"pathRoot", "<>", "\"\<step_2.mx\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", 
  RowBox[{"pathRoot", "<>", "\"\<step_3.mx\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", 
  RowBox[{"pathRoot", "<>", "\"\<step_4.mx\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.671292053053907*^9, 3.671292056414295*^9}}],

Cell[CellGroupData[{

Cell["5.a Read all sinograms and reconstruct into slices", "Subsection",
 CellChangeTimes->{{3.4562833726280527`*^9, 3.456283385607916*^9}, {
   3.463555031609515*^9, 3.463555047770688*^9}, 3.463590933610998*^9, 
   3.463591573151423*^9, {3.463681205490497*^9, 3.463681218422361*^9}, {
   3.463723051179096*^9, 3.463723089887204*^9}, {3.463723208493277*^9, 
   3.463723230746255*^9}, {3.4637256437176247`*^9, 3.463725653299542*^9}, {
   3.5585382959271193`*^9, 3.5585383086354237`*^9}, {3.55854004855441*^9, 
   3.558540077963007*^9}, {3.559417017428619*^9, 3.55941702707549*^9}, {
   3.67129198631511*^9, 3.6712919879605913`*^9}, 3.671293057353076*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"listFilenamesSinograms", " ", "=", " ", 
   RowBox[{"FileNames", "[", 
    RowBox[{"\"\<sinogram*.fits\>\"", ",", "pathSinograms"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ParallelTable", "[", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"filenameSinogram", "=", 
        RowBox[{"listFilenamesSinograms", "[", 
         RowBox[{"[", "indexSlice", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"filenameSlice", " ", "=", " ", 
        RowBox[{"pathSlices", "<>", 
         RowBox[{"StringReplace", "[", 
          RowBox[{
           RowBox[{"Last", "[", 
            RowBox[{"FileNameSplit", "[", "filenameSinogram", "]"}], "]"}], 
           ",", 
           RowBox[{"\"\<sinogram\>\"", "\[Rule]", "\"\<slice\>\""}]}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sinogram", " ", "=", "  ", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{"filenameSinogram", ",", "\"\<RawData\>\""}], " ", "]"}], 
         "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"slice", " ", "=", " ", 
        RowBox[{"ImageData", "[", 
         RowBox[{
          RowBox[{"InverseRadon", "[", 
           RowBox[{"Image", "[", 
            RowBox[{"sinogram", ",", "\"\<Real\>\""}], "]"}], "]"}], ",", 
          "\"\<Real\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"filenameSlice", ",", "slice"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"indexSlice", ",", 
      RowBox[{"Length", "[", "listFilenamesSinograms", "]"}]}], " ", "}"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.671292138105377*^9, 3.671292229566505*^9}, {
   3.671292421177885*^9, 3.6712925104603167`*^9}, {3.671292541995384*^9, 
   3.6712925494319277`*^9}, {3.671292682912389*^9, 3.6712927015904827`*^9}, 
   3.671292761979595*^9, {3.671292805159575*^9, 3.6712928188442163`*^9}, {
   3.671293019321335*^9, 3.6712930268864937`*^9}, {3.6712943843242683`*^9, 
   3.6712943883322487`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["5.b Read all slices and save as one HDF5 volume", "Subsection",
 CellChangeTimes->{{3.4562833726280527`*^9, 3.456283385607916*^9}, {
   3.463555031609515*^9, 3.463555047770688*^9}, 3.463590933610998*^9, 
   3.463591573151423*^9, {3.463681205490497*^9, 3.463681218422361*^9}, {
   3.463723051179096*^9, 3.463723089887204*^9}, {3.463723208493277*^9, 
   3.463723230746255*^9}, {3.4637256437176247`*^9, 3.463725653299542*^9}, {
   3.5585382959271193`*^9, 3.5585383086354237`*^9}, {3.55854004855441*^9, 
   3.558540077963007*^9}, {3.559417017428619*^9, 3.55941702707549*^9}, {
   3.67129198631511*^9, 3.6712919879605913`*^9}, 3.671293047799012*^9, {
   3.6712931044899273`*^9, 3.671293110793961*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"listFilenamesSlices", " ", "=", " ", 
   RowBox[{"FileNames", "[", 
    RowBox[{"\"\<slice*.fits\>\"", ",", "pathSlices"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"slice", " ", "=", "  ", 
   RowBox[{
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"listFilenamesSlices", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<RawData\>\""}], " ", "]"}], 
    "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"NX", ",", "NY"}], "}"}], "=", 
   RowBox[{"Dimensions", "[", "slice", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NZ", " ", "=", " ", 
   RowBox[{"Length", "[", "listFilenamesSlices", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"volume", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"NY", ",", "NX", ",", "NZ"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"indexSlice", " ", "=", "1"}], ",", 
    RowBox[{"indexSlice", "\[LessEqual]", " ", "NZ"}], ",", 
    RowBox[{"indexSlice", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"slice", " ", "=", "  ", 
      RowBox[{
       RowBox[{"Import", "[", 
        RowBox[{
         RowBox[{"listFilenamesSlices", "[", 
          RowBox[{"[", "indexSlice", "]"}], "]"}], ",", "\"\<RawData\>\""}], 
        " ", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"volume", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "All", ",", "indexSlice"}], "]"}], "]"}], "=", 
      "slice"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "volume", "]"}]}], "Input",
 CellChangeTimes->{{3.671293160688946*^9, 3.671293274242875*^9}, {
  3.671293317423524*^9, 3.671293327775302*^9}, {3.671294583727705*^9, 
  3.671294588088141*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"filenameHDF5", " ", "=", 
   RowBox[{"pathVolumes", "<>", "\"\<volume.h5\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{"filenameHDF5", ",", 
   RowBox[{"{", 
    RowBox[{"volume", ",", "angleList", ",", 
     RowBox[{"{", "bestShift", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\"\<Datasets\>\"", ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<volume\>\"", ",", "\"\<angleList\>\"", ",", "\"\<bestShift\>\""}], 
      "}"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.671294668643642*^9, 3.671294683242413*^9}, {
  3.6712947668728857`*^9, 3.6712948133388844`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["5.c DumpSave", "Subsection",
 CellChangeTimes->{{3.671211179812208*^9, 3.671211200099522*^9}, {
   3.671211329699849*^9, 3.671211387716975*^9}, 3.6712140481610613`*^9, {
   3.6712166499891567`*^9, 3.671216651875024*^9}, 3.6712339364194517`*^9, {
   3.67129304964709*^9, 3.671293052039201*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DumpSave", "[", 
   RowBox[{
    RowBox[{"pathRoot", "<>", "\"\<step_3.mx\>\""}], ",", 
    RowBox[{"{", "angleList", "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]}], "Input",
 CellChangeTimes->{{3.670170487070524*^9, 3.670170492548648*^9}, {
   3.670170608253581*^9, 3.6701706092764063`*^9}, {3.671216602745532*^9, 
   3.671216611939556*^9}, {3.6712166842956038`*^9, 3.671216690287579*^9}, 
   3.671216778684046*^9, 3.671217190175748*^9, {3.6712253696102533`*^9, 
   3.671225371499885*^9}, {3.67123037984468*^9, 3.671230387994924*^9}, {
   3.67123393979906*^9, 3.6712339674821463`*^9}, 3.6712856119170523`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Step 6. Store all slices into one HDF5 file", "Section",
 CellChangeTimes->{{3.4562833726280527`*^9, 3.456283385607916*^9}, {
   3.463555031609515*^9, 3.463555047770688*^9}, 3.463590933610998*^9, 
   3.463591573151423*^9, {3.463681205490497*^9, 3.463681218422361*^9}, {
   3.463723051179096*^9, 3.463723089887204*^9}, {3.463723208493277*^9, 
   3.463723230746255*^9}, {3.4637256437176247`*^9, 3.463725653299542*^9}, {
   3.4637352447475653`*^9, 3.463735272288422*^9}, 3.558541061207158*^9, {
   3.558541839945931*^9, 3.5585418472786827`*^9}, {3.559417056419635*^9, 
   3.559417059474881*^9}}],

Cell[BoxData[{
 RowBox[{"pathRoot", " ", "=", " ", 
  "\"\</melete-nas01/lsu/scratch/BulletData/\>\""}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", 
  RowBox[{"pathRoot", "<>", "\"\<step_1.mx\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", 
  RowBox[{"pathRoot", "<>", "\"\<step_2.mx\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", 
  RowBox[{"pathRoot", "<>", "\"\<step_3.mx\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", 
  RowBox[{"pathRoot", "<>", "\"\<step_4.mx\>\""}], "]"}]}], "Input"],

Cell[CellGroupData[{

Cell["6.a. Make a 3D ", "Subsection",
 CellChangeTimes->{{3.4558819968069572`*^9, 3.4558820051319237`*^9}, {
   3.455882868266423*^9, 3.4558828690740147`*^9}, {3.4560290684184227`*^9, 
   3.456029095809671*^9}, {3.456058322376678*^9, 3.456058333590066*^9}, 
   3.456059019133485*^9, {3.458939659792389*^9, 3.4589396817833548`*^9}, {
   3.458939771234117*^9, 3.458939781729702*^9}, {3.4589399794638*^9, 
   3.458939994869102*^9}, {3.4589400300059767`*^9, 3.458940048384411*^9}, {
   3.460200168167982*^9, 3.460200185694607*^9}, {3.460480218863645*^9, 
   3.460480228797215*^9}, {3.463736969589325*^9, 3.463736972051629*^9}, {
   3.463749850088729*^9, 3.4637498643896437`*^9}, {3.5585418168261766`*^9, 
   3.558541860594099*^9}, {3.558542254629272*^9, 3.558542256722129*^9}, {
   3.5594170743506517`*^9, 3.559417077355424*^9}, {3.5594764927420073`*^9, 
   3.559476496396463*^9}, 3.559477359592424*^9, 3.559478049293518*^9, {
   3.559478366569104*^9, 3.559478371265679*^9}, {3.559478430547901*^9, 
   3.559478452763938*^9}, {3.569143544597402*^9, 3.569143566131955*^9}, {
   3.671294926001083*^9, 3.671294928302683*^9}, {3.671294989148859*^9, 
   3.671294992689995*^9}}],

Cell[BoxData[
 RowBox[{"filenameVolume", " ", "=", " ", 
  RowBox[{
   RowBox[{"FileNames", "[", 
    RowBox[{"\"\<*.h5\>\"", ",", "pathVolumes"}], "]"}], "//", 
   "First"}]}]], "Input",
 CellChangeTimes->{{3.6712950125970573`*^9, 3.6712950379090223`*^9}}],

Cell[BoxData[{
 RowBox[{"Import", "[", "filenameVolume", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"volumeData", " ", "=", " ", 
   RowBox[{"Import", "[", 
    RowBox[{"filenameVolume", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Datasets\>\"", ",", "\"\</volume\>\""}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"NX", ",", "NY", ",", "NZ"}], "}"}], "=", 
  RowBox[{"Dimensions", "[", "volumeData", "]"}]}]}], "Input",
 CellChangeTimes->{{3.671295040521675*^9, 3.671295105881743*^9}, {
  3.671295148532577*^9, 3.6712951603028593`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"volumeImage", " ", "=", 
   RowBox[{"ImageAdjust", "[", 
    RowBox[{"Image3D", "[", 
     RowBox[{"volumeData", ",", "\"\<Real\>\""}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ImageHistogram", "[", "volumeImage", "]"}]}], "Input",
 CellChangeTimes->{{3.671295139395397*^9, 3.671295175023164*^9}, {
  3.671295247034746*^9, 3.671295275416801*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"volumeBinary", " ", "=", 
   RowBox[{"DeleteSmallComponents", "[", 
    RowBox[{
     RowBox[{"Binarize", "[", 
      RowBox[{"volumeImage", ",", "0.45"}], "]"}], ",", "5"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6712952903446007`*^9, 3.671295389358685*^9}, 
   3.6712957156394053`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"volumeImage", " ", "=", " ", 
   RowBox[{"ImageMultiply", "[", 
    RowBox[{"volumeImage", ",", "volumeBinary"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.671295417034503*^9, 3.67129543469839*^9}, 
   3.671295712095199*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"gAttenuationVolume", "=", 
   RowBox[{"Image3D", "[", 
    RowBox[{
     RowBox[{"ImageAdjust", "[", 
      RowBox[{"volumeImage", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.0", ",", "0.8"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Axes", "\[Rule]", "True"}], ",", 
     RowBox[{"Boxed", "\[Rule]", "True"}], ",", 
     RowBox[{"BoxRatios", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"BoxStyle", "\[Rule]", 
      RowBox[{"Directive", "[", "White", "]"}]}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"Axes", "\[Rule]", "True"}], ",", 
     RowBox[{"AxesLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<slices\>\"", ",", "\"\<columns\>\"", ",", "\"\<rows\>\""}], 
       "}"}]}], ",", 
     RowBox[{"AxesStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"White", ",", "14"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"ColorFunction", "\[Rule]", "\"\<XRay\>\""}], ",", 
     RowBox[{"Background", "\[Rule]", "Black"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ViewVertical", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}]}], ",", 
     RowBox[{"ViewPoint", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1.0"}], ",", " ", 
        RowBox[{"-", "5.0"}], ",", " ", "1.0"}], "}"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "700"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.671295505590644*^9, 3.671295542054574*^9}, {
   3.671295594854949*^9, 3.671295630571504*^9}, {3.671295672269792*^9, 
   3.671295675077611*^9}, {3.6712957319559917`*^9, 3.671295734016686*^9}, 
   3.671295808942718*^9, 3.67129584775056*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"pathFigures", "<>", "\"\<attenuation_volume.png\>\""}], ",", 
    "gAttenuationVolume", ",", "\"\<png\>\""}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.671295900346425*^9, 3.67129590663688*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
Evaluator->"Melete_04",
WindowSize->{1461, 996},
WindowMargins->{{Automatic, 28}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
PrintingOptions->{"PaperOrientation"->"Portrait"},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
Magnification:>1.5 Inherited,
FrontEndVersion->"10.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 9, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 703, 9, 44, "Subsubtitle"],
Cell[1286, 33, 840, 13, 164, "Text"],
Cell[2129, 48, 711, 17, 341, "Text"],
Cell[CellGroupData[{
Cell[2865, 69, 449, 6, 95, "Section"],
Cell[CellGroupData[{
Cell[3339, 79, 158, 2, 65, "Subsection"],
Cell[3500, 83, 459, 7, 69, "Input"],
Cell[3962, 92, 136, 4, 43, "Input"],
Cell[4101, 98, 324, 6, 94, "Input"],
Cell[4428, 106, 1199, 27, 169, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5664, 138, 176, 2, 65, "Subsection"],
Cell[5843, 142, 525, 9, 105, "Text"],
Cell[6371, 153, 2298, 55, 244, "Input"],
Cell[8672, 210, 3574, 88, 369, "Input"],
Cell[12249, 300, 2826, 72, 344, "Input"],
Cell[15078, 374, 1065, 28, 169, "Input"],
Cell[16146, 404, 2441, 57, 269, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[18624, 466, 174, 2, 51, "Subsection"],
Cell[18801, 470, 1001, 18, 119, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[19851, 494, 427, 5, 95, "Section"],
Cell[20281, 501, 511, 12, 94, "Input"],
Cell[CellGroupData[{
Cell[20817, 517, 250, 3, 65, "Subsection"],
Cell[21070, 522, 1164, 30, 119, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[22271, 557, 244, 3, 51, "Subsection"],
Cell[22518, 562, 1670, 34, 94, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[24225, 601, 335, 4, 51, "Subsection"],
Cell[24563, 607, 1327, 28, 94, "Input"],
Cell[25893, 637, 886, 23, 98, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[26816, 665, 372, 4, 51, "Subsection"],
Cell[27191, 671, 729, 12, 105, "Text"],
Cell[27923, 685, 3349, 73, 244, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[31309, 763, 537, 8, 51, "Subsection"],
Cell[31849, 773, 682, 15, 69, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[32568, 793, 546, 7, 51, "Subsection"],
Cell[33117, 802, 1414, 29, 94, "Input"],
Cell[34534, 833, 930, 20, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35501, 858, 226, 3, 65, "Subsection"],
Cell[35730, 863, 739, 14, 69, "Input"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[36518, 883, 450, 6, 95, "Section"],
Cell[36971, 891, 711, 16, 119, "Input"],
Cell[CellGroupData[{
Cell[37707, 911, 396, 5, 65, "Subsection"],
Cell[38106, 918, 2461, 58, 319, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[40604, 981, 542, 8, 51, "Subsection"],
Cell[41149, 991, 627, 17, 43, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[41813, 1013, 478, 6, 51, "Subsection"],
Cell[42294, 1021, 123, 1, 46, "Text"],
Cell[42420, 1024, 1673, 41, 144, "Input"],
Cell[44096, 1067, 1375, 30, 144, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[45508, 1102, 615, 10, 88, "Subsection"],
Cell[46126, 1114, 6761, 128, 498, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52924, 1247, 710, 11, 65, "Subsection"],
Cell[53637, 1260, 2187, 54, 244, "Input"],
Cell[55827, 1316, 1973, 52, 219, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[57837, 1373, 549, 7, 51, "Subsection"],
Cell[58389, 1382, 3302, 76, 319, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61728, 1463, 565, 7, 65, "Subsection"],
Cell[62296, 1472, 3725, 83, 444, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[66058, 1560, 250, 3, 51, "Subsection"],
Cell[66311, 1565, 700, 12, 69, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[67060, 1583, 590, 8, 72, "Section"],
Cell[67653, 1593, 601, 13, 119, "Input"],
Cell[CellGroupData[{
Cell[68279, 1610, 581, 7, 65, "Subsection"],
Cell[68863, 1619, 1092, 18, 69, "Input"],
Cell[69958, 1639, 1560, 39, 219, "Input"],
Cell[71521, 1680, 3734, 86, 319, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[75292, 1771, 686, 9, 51, "Subsection"],
Cell[75981, 1782, 2567, 71, 219, "Input"],
Cell[78551, 1855, 2434, 58, 269, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[81022, 1918, 735, 9, 51, "Subsection"],
Cell[81760, 1929, 196, 5, 43, "Input"],
Cell[81959, 1936, 1337, 30, 219, "Input"],
Cell[83299, 1968, 2052, 49, 219, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85388, 2022, 713, 9, 65, "Subsection"],
Cell[86104, 2033, 1061, 24, 144, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87202, 2062, 299, 4, 65, "Subsection"],
Cell[87504, 2068, 844, 15, 69, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[88397, 2089, 885, 14, 124, "Section"],
Cell[89285, 2105, 606, 14, 144, "Input"],
Cell[CellGroupData[{
Cell[89916, 2123, 653, 8, 65, "Subsection"],
Cell[90572, 2133, 2232, 51, 244, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[92841, 2189, 702, 9, 65, "Subsection"],
Cell[93546, 2200, 2022, 56, 269, "Input"],
Cell[95571, 2258, 654, 17, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[96262, 2280, 299, 4, 65, "Subsection"],
Cell[96564, 2286, 700, 12, 69, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[97313, 2304, 598, 8, 95, "Section"],
Cell[97914, 2314, 540, 13, 144, "Input"],
Cell[CellGroupData[{
Cell[98479, 2331, 1167, 16, 65, "Subsection"],
Cell[99649, 2349, 257, 6, 43, "Input"],
Cell[99909, 2357, 591, 14, 94, "Input"],
Cell[100503, 2373, 401, 9, 69, "Input"],
Cell[100907, 2384, 334, 9, 43, "Input"],
Cell[101244, 2395, 265, 6, 43, "Input"],
Cell[101512, 2403, 1791, 42, 144, "Input"],
Cell[103306, 2447, 273, 6, 102, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
